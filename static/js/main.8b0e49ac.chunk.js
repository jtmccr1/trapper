(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(t,e,n){t.exports=n.p+"static/media/logo.e67d1199.png"},22:function(t,e,n){t.exports=n(50)},49:function(t,e,n){},50:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),i=n(20),c=n.n(i),o=n(21),s=n.n(o);var l=function(){return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"logo"},r.a.createElement("a",{href:"http://artic.network",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:s.a,alt:"logo",width:"132"}))),r.a.createElement("div",{className:"title"},r.a.createElement("h2",null,r.a.createElement("div",{style:{fontSize:"1.8em"}},"TRAPPER"),r.a.createElement("div",null,"Transmission Reconstuction And Phylogenetics Promoting Early Response"))))},u=n(13),h=n(9),f=n(5),g=n(17),d=n(11),m=n(7),v=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;Object(d.a)(this,t);var a=new Map([].concat(Object(h.a)(t.DEFAULT_MAP()),Object(h.a)(n)));this.symptomOnset=e[a.get("symptomOnset")]?e[a.get("symptomOnset")]:"Unknown",this.sampleDate=e[a.get("sampleDate")]?e[a.get("sampleDate")]:"Unknown",this.resolution=e[a.get("resolution")]?e[a.get("resolution")]:"Unknown",this.resoultionDate=e[a.get("resolutionDate")]?e[a.get("resolutionDate")]:"Unknown",this.id=e[a.get("id")]?e[a.get("id")]:"Unknown",this.location=e[a.get("location")]?e[a.get("location")]:"Unknown",this.caseId=Symbol(),this.metadata={};var r=!0,i=!1,c=void 0;try{for(var o,s=Object.keys(e).filter(function(t){return-1===Object(h.a)(a.values()).indexOf(t)})[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;this.metadata[l]=e[l]}}catch(u){i=!0,c=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw c}}}return Object(m.a)(t,null,[{key:"DEFAULT_MAP",value:function(){return new Map([["symptomOnset","symptomOnset"],["sampleDate","sampleDate"],["resolution","resolution"],["resolutionDate","resolutionDate"],["id","id"],["location","location"]])}}]),Object(m.a)(t,[{key:"getSymptomOnset",value:function(){return new Date(this.symptomOnset.valueOf())}},{key:"getSampleDate",value:function(){return this.sampleDate.map(function(t){return new Date(t.valueOf())})}},{key:"getResolution",value:function(){return this.resolution}},{key:"getResolutionDate",value:function(){return new Date(this.resolutionDate.valueOf())}},{key:"getId",value:function(){return this.id}},{key:"getCaseId",value:function(){return this.caseId}},{key:"getLocation",value:function(){return this.location}}]),t}(),b=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;Object(d.a)(this,t);var a=new Map([].concat(Object(h.a)(t.DEFAULT_MAP()),Object(h.a)(n)));this.target=e[a.get("target")]?e[a.get("target")]:"Unknown",this.source=e[a.get("source")]?e[a.get("source")]:"Unknown",this.dataSource=e[a.get("dataSource")]?e[a.get("dataSource")]:"Unknown",this.metadata={};var r=!0,i=!1,c=void 0;try{for(var o,s=Object.keys(e).filter(function(t){return-1===Object(h.a)(a.values()).indexOf(t)})[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;this.metadata[l]=e[l]}}catch(u){i=!0,c=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw c}}}return Object(m.a)(t,null,[{key:"DEFAULT_MAP",value:function(){return new Map([["target","target"],["source","source"],["dataSource","dataSource"]])}}]),t}(),y=n(16),O=Object(y.b)("%Y-%m-%d"),p=n(10),j=n(1),w=n(3),x=n(12),k=n(6),S=n(14),E=n(2),D=n(15),T=(n(19),function(){function t(e,n,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(d.a)(this,t),this.layout=n,this.margins=a,this.settings=Object(u.a)({},t.DEFAULT_SETTINGS(),r),this.svg=e}return Object(m.a)(t,null,[{key:"DEFAULT_SETTINGS",value:function(){return{hoverBorder:2,backgroundBorder:0,baubles:[],transitionDuration:500}}}]),Object(m.a)(t,[{key:"draw",value:function(){var t,e,n=this;t=Object.keys(this.settings).indexOf("width")>-1?this.settings.width:this.svg.getBoundingClientRect().width,e=Object.keys(this.settings).indexOf("height")>-1?this.settings.height:this.svg.getBoundingClientRect().height,Object(E.c)(this.svg).select("g").remove(),Object(E.c)(this.svg).append("g").attr("transform","translate(".concat(this.margins.left,",").concat(this.margins.top,")")),this.svgSelection=Object(E.c)(this.svg).select("g"),this.svgSelection.append("g").attr("class","axes-layer"),this.settings.backgroundBorder>0&&this.svgSelection.append("g").attr("class","rect-background-layer"),this.svgSelection.append("g").attr("class","rect-layer");var a=Object(p.b)().domain(this.layout.horizontalRange).range([this.margins.left,t-this.margins.right-this.margins.left]),r=Object(p.a)().domain(this.layout.verticalRange).range([e-this.margins.bottom-this.margins.top,this.margins.top]);this.scales={x:a,y:r,width:t,height:e},function(){var t=this.svgSelection.select(".axes-layer");t.append("g").attr("class","x axis").attr("id","x-axis").attr("transform","translate(0, ".concat(this.scales.height-this.margins.bottom+5,")")).call(Object(S.a)(this.scales.x)),t.append("g").attr("class","y axis").attr("id","y-axis").attr("transform","translate(".concat(this.margins.left,",0)")).call(Object(S.b)(this.scales.y))}.call(this,this.margins),this.bins=[],this.layout.updateCallback=function(){n.update()},this.update()}},{key:"update",value:function(){var t,e;this.bins=[],this.layout.layout(this.bins),t=Object.keys(this.settings).indexOf("width")>-1?this.settings.width:this.svg.getBoundingClientRect().width,e=Object.keys(this.settings).indexOf("height")>-1?this.settings.height:this.svg.getBoundingClientRect().height,this.scales.x.domain(this.layout.horizontalRange).range([this.margins.left,t-this.margins.right-this.margins.left]),this.scales.y.domain(this.layout.verticalRange).range([e-this.margins.bottom-this.margins.top,this.margins.top]),this.scales.width=t,this.scales.height=e,function(){this.svgSelection.select("#x-axis").call(Object(S.a)(this.scales.x)).transition().duration(this.settings.transitionDuration).ease(D.b),this.svgSelection.select("#y-axis").attr("transform","translate(".concat(this.margins.left.height,",0)")).call(Object(S.b)(this.scales.y).ticks(5)).transition().duration(this.settings.transitionDuration).ease(D.b)}.call(this),this.settings.backgroundBorder>0&&function(){var t=this,e=this.svgSelection.select(".rect-background-layer").selectAll(".rect-background").data(this.bins,function(t){return"cb_".concat(t.data.id)});e.enter().append("rect").attr("id",function(t){return t.id}).attr("class",function(t){return["rect-background"].join(" ")}).attr("x",function(e){return t.scales.x(e.x0)+1}).attr("width",function(e){return Math.max(0,t.scales.x(e.x1)-t.scales.x(e.x0)-1)}).attr("y",function(e){return t.scales.y(e.y1)}).attr("height",function(e){return t.scales.y(e.y0)-t.scales.y(e.y1)});e.transition().duration(this.settings.transitionDuration).attr("x",function(e){return t.scales.x(e.x0)+1}).attr("width",function(e){return Math.max(0,t.scales.x(e.x1)-t.scales.x(e.x0)-1)}).attr("y",function(e){return t.scales.y(e.y1)}).attr("height",function(e){return t.scales.y(e.y0)-t.scales.y(e.y1)}),e.exit().remove()}.call(this),function(){var t=this,e=Object(E.c)(this.svg).select(".rect-layer").selectAll(".rect").data(this.bins,function(t){return"c_".concat(t.data.id)});e.enter().append("rect").attr("id",function(t){return t.id}).attr("class",function(t){return["rect"].join(" ")}).attr("x",function(e){return t.scales.x(e.x0)+1}).attr("width",function(e){return Math.max(0,t.scales.x(e.x1)-t.scales.x(e.x0)-1)}).attr("y",function(e){return t.scales.y(e.y1)}).attr("height",function(e){return t.scales.y(e.y0)-t.scales.y(e.y1)});e.transition().duration(this.settings.transitionDuration).attr("x",function(e){return t.scales.x(e.x0)+1}).attr("width",function(e){return Math.max(0,t.scales.x(e.x1)-t.scales.x(e.x0)-1)}).attr("y",function(e){return t.scales.y(e.y1)}).attr("height",function(e){return t.scales.y(e.y0)-t.scales.y(e.y1)}),e.exit().remove()}.call(this)}},{key:"onHover",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.svgSelection.selectAll("".concat(e||".rect"));console.log(n),n.on("mouseover",function(e,n,a){t.enter(e,n,a)}),n.on("mouseout",function(e,n,a){t.exit(e,n,a)})}}]),t}());var R=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(d.a)(this,t),this.settings=Object(u.a)({},t.DEFAULT_SETTINGS(),n),this.data=e,this._horizontalRange=[0,1],this._verticalRange=[1,0]}return Object(m.a)(t,null,[{key:"DEFAULT_SETTINGS",value:function(){return{groupingFunction:function(t){return 1},binnedFunction:function(t){return j.j.floor(t.symptomOnset)},keyToXFunction:{x0:function(t){return Object(j.j)(new Date(t.key))},x1:function(t){return j.j.offset(new Date(t.key),1)}}}}}]),Object(m.a)(t,[{key:"layout",value:function(t){var e=this,n=Object(x.b)().key(function(t){return j.j.floor(t.symptomOnset)}).entries(this.data).map(function(t){return{x0:Object(j.j)(new Date(t.key)),x1:j.j.offset(new Date(t.key),1),values:t.values}}),a=this.data.map(function(t){return e.settings.groupingFunction(t)}).reduce(function(t,e){return-1===t.indexOf(e)&&t.push(e),t},[]),r=0,i=0,c=!0,o=!1,s=void 0;try{for(var l,h=n[Symbol.iterator]();!(c=(l=h.next()).done);c=!0){var f=l.value;r=0;var g=!0,d=!1,m=void 0;try{for(var v,b=function(){var n=v.value,a=f.values.filter(function(t){return e.settings.groupingFunction(t)===n}),i={x0:f.x0,x1:f.x1,colorKey:n};if(a.length>0){var c=!0,o=!1,s=void 0;try{for(var l,h=a[Symbol.iterator]();!(c=(l=h.next()).done);c=!0){var g=l.value,d=Object(u.a)({},i,{data:g});d.y0=r,d.y1=r+1,r+=1,t.push(d)}}catch(m){o=!0,s=m}finally{try{c||null==h.return||h.return()}finally{if(o)throw s}}}},y=a[Symbol.iterator]();!(g=(v=y.next()).done);g=!0)b()}catch(O){d=!0,m=O}finally{try{g||null==y.return||y.return()}finally{if(d)throw m}}i=Object(w.e)([i,r])}}catch(O){o=!0,s=O}finally{try{c||null==h.return||h.return()}finally{if(o)throw s}}this._horizontalRange=[Object(w.f)(n,function(t){return t.x0}),Object(w.e)(n,function(t){return t.x1})],this._verticalRange=[0,i]}},{key:"update",value:function(){this.updateCallback()}},{key:"horizontalRange",get:function(){return this._horizontalRange}},{key:"verticalRange",get:function(){return this._verticalRange}}]),t}();var C=function(t){var e=Object(a.useState)(null),n=Object(f.a)(e,2),i=n[0],c=n[1],o=Object(a.useCallback)(function(e){if(null!==e)if(0===e.children.length){var n=new R(t.data),a={top:t.chartGeom.spaceTop,bottom:10,left:50,right:50},r=new T(e,n,a,{hoverBorder:4,backgroundBorder:0,transitionDuration:300});r.draw();var o={enter:function(t,e,n){Object(E.c)(n[e]).classed("hovered",!0)},exit:function(t,e,n){Object(E.c)(n[e]).classed("hovered",!1)}};r.onHover(o),Object(E.c)(e).select(".axes-layer").remove(),c(r)}else i.update()}),s="b".concat(Math.random().toString(36).substring(4));return r.a.createElement("svg",{className:"chart",id:s,ref:o,height:t.chartGeom.height,width:t.chartGeom.width})};var N=function(t){var e=Object(a.useState)(null),n=Object(f.a)(e,2),i=n[0],c=n[1],o=Object(a.useCallback)(function(e){if(null!==e)if(0===e.children.length){var n=new t.layout(t.phylogeny),a={top:t.chartGeom.spaceTop,bottom:10,left:10,right:50},r=new k.FigTree(e,n,a,{hoverBorder:4,backgroundBorder:2,baubles:[new k.CircleBauble],transitionDuration:300});r.draw(),r.hilightInternalNodes(),r.hilightExternalNodes(),r.hilightBranches(),r.onClickNode(function(t){return console.log(t)}),Object(E.c)(e).select(".axes-layer").remove(),c(r)}else i.update()}),s="b".concat(Math.random().toString(36).substring(4));return r.a.createElement("svg",{className:"chart",id:s,ref:o,height:t.chartGeom.height,width:t.chartGeom.width})};r.a.forwardRef(function(t,e){return r.a.createElement("svg",{className:"chart",ref:e,height:t.chartGeom.height,width:t.chartGeom.width})});var B=function(t){var e=Object(a.useState)(null),n=Object(f.a)(e,2),i=n[0],c=n[1],o=Object(p.b)().domain([new Date("2018-08-29"),new Date("2018-12-01")]).range([0,1]),s=function(t,e){return"UnsampledrootCase"===t.id?o.range()[0]:o(t.symptomOnset)},l=Object(a.useCallback)(function(e){if(null!==e)if(0===e.children.length){var n=new k.ArcLayout(t.graph,{xFunction:s,curve:t.curve}),a={top:t.chartGeom.spaceTop,bottom:10,left:10,right:50},r={hoverBorder:4,backgroundBorder:2,baubles:[new k.CircleBauble],transitionDuration:300},o=new k.FigTree(e,n,a,r);o.draw(),o.hilightInternalNodes(),o.hilightExternalNodes(),o.hilightBranches(),Object(E.c)(e).select(".axes-layer").remove(),c(o)}else i.update()}),u="b".concat(Math.random().toString(36).substring(4));return r.a.createElement("svg",{className:"chart",id:u,ref:l,height:t.chartGeom.height,width:t.chartGeom.width})};var L=function(t){var e="https://raw.githubusercontent.com/jtmccr1/trapper/master/src",n=Object(a.useState)(null),i=Object(f.a)(n,2),c=i[0],o=i[1],s=Object(a.useState)(null),l=Object(f.a)(s,2),d=l[0],m=l[1],y=Object(a.useState)(null),S=Object(f.a)(y,2),E=S[0],D=S[1],T=Object(a.useState)(null),R=Object(f.a)(T,2),L=R[0],G=R[1],A=Object(a.useState)(null),U=Object(f.a)(A,2),M=U[0],_=U[1],F=Object(a.useState)(null),I=Object(f.a)(F,2),z=I[0],P=I[1],H=Object(a.useState)(null),J=Object(f.a)(H,2),W=J[0],K=J[1],X=Object(a.useState)(null),Y=Object(f.a)(X,2),$=Y[0],q=Y[1],Q=Object(a.useState)(null),V=Object(f.a)(Q,2),Z=V[0],tt=V[1];Object(a.useEffect)(function(){Object(g.a)("".concat(e,"/examples/simulated/LineList.csv"),function(t){var e={id:t.id,symptomOnset:O(t.symptomOnset),sampleDate:[O(t.sampleDate)],location:t.Location,resolution:t.Outcome};return new v(e)}).then(function(t){o(t)})},[]),Object(a.useEffect)(function(){Promise.all([Object(g.a)("".concat(e,"/examples/simulated/transphyloLinks.csv"),function(t){var e={target:t.target,source:t.source,dataSource:t.dataSource};return new b(e)}),Object(g.a)("".concat(e,"/examples/simulated/epiContacts.csv"),function(t){var e={target:t.target,source:t.source,dataSource:t.dataSource};return new b(e)})]).then(function(t){var e=Object(f.a)(t,2),n=e[0],a=e[1];return m([].concat(Object(h.a)(n),Object(h.a)(a)))})},[]),Object(a.useEffect)(function(){fetch("".concat(e,"/examples/simulated/simulated.trees")).then(function(t){return t.text().then(function(t){K(k.Tree.parseNewick(t))})}),fetch("".concat(e,"/examples/simulated/simulated.json")).then(function(t){return t.json().then(function(t){q(t)})})},[]),Object(a.useEffect)(function(){if(null!=d){var t=Object(x.b)().key(function(t){return t.target}).key(function(t){return t.source}).key(function(t){return t.dataSource}).entries(d),e=[];d.forEach(function(t){-1===e.indexOf(t.dataSource)&&e.push(t.dataSource)});var n=[],a=!0,r=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){for(var l=o.value,u=l.key,f={},g=function(){var t=b[m];f[t]=l.values.map(function(e){return e.values.filter(function(e){return e.key==t})}).reduce(function(t,e){return t.concat(e)},[]).reduce(function(t,e){return t+e.values.length},0)},m=0,b=e;m<b.length;m++)g();var y=!0,O=!1,p=void 0;try{for(var j,w=l.values[Symbol.iterator]();!(y=(j=w.next()).done);y=!0){var S=j.value,E=S.key,D=e.reduce(function(t,e){return t[e]={support:null,data:[]},t},{}),T=!0,R=!1,C=void 0;try{for(var N,B=S.values[Symbol.iterator]();!(T=(N=B.next()).done);T=!0){var L=N.value;D[L.key].data=L.values,D[L.key].support=0!==f[L.key]?L.values.length/f[L.key]:null}}catch(H){R=!0,C=H}finally{try{T||null==B.return||B.return()}finally{if(R)throw C}}n.push({target:u,source:E,metaData:D})}}catch(H){O=!0,p=H}finally{try{y||null==w.return||w.return()}finally{if(O)throw p}}}}catch(H){r=!0,i=H}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}var G=n.map(function(t){return t.source}).reduce(function(t,e){return-1===t.indexOf(e)?t.concat(e):t},[]),A=Object(h.a)(c),U=!0,M=!1,_=void 0;try{for(var F,I=function(){var t=F.value;if(0===A.filter(function(e){return e.id===t}).length){var e=new v({id:t});A.push(e)}},z=G[Symbol.iterator]();!(U=(F=z.next()).done);U=!0)I()}catch(H){M=!0,_=H}finally{try{U||null==z.return||z.return()}finally{if(M)throw _}}P(new k.Graph(A,n))}},[d,c]),Object(a.useEffect)(function(){if(null!==c&&null!==L){var t=Object(j.j)(Object(w.f)(c,function(t){return Object(j.j)(t.getSymptomOnset())})),e=Object(j.j)(Object(w.e)(c,function(t){return Object(j.j)(t.getSymptomOnset())})),n={x:Object(p.b)().domain([j.j.offset(t,-1),j.j.offset(e,2)]).range([L.spaceLeft,L.width-L.spaceRight]),y:Object(p.a)().domain([0,1]).range([L.height-L.spaceBottom,L.spaceTop])};n.weeks=j.j.range(n.x.domain()[0],j.j.offset(n.x.domain()[1],1)),D(n)}},[c,L]),Object(a.useEffect)(function(){if(null!==M){var t={height:Object(w.e)([.25*M.height,50]),width:Object(w.e)([.9*M.width,50])};G(Object(u.a)({},{spaceTop:5,spaceBottom:20,spaceLeft:60,spaceRight:60},t))}},[M]),Object(a.useEffect)(function(){if(null!==W&&null!==z){var t=Object(w.d)(z.nodes,function(t){return t.symptomOnset}),e=Object(w.e)(W.nodes,function(t){return W.rootToTipLength(t)}),n=W.nodes.find(function(t){return W.rootToTipLength(t)===e}),a=z.getNode(n.name).getSymptomOnset(),r=j.k.offset(a,-1*W.rootToTipLength(W.rootNode));tt(Object(w.d)([r].concat(Object(h.a)(t))))}},[c,z]);var et=Object(a.useCallback)(function(t){if(null!==t){_({height:t.getBoundingClientRect().height,width:t.getBoundingClientRect().width});var e=function(){_({height:t.getBoundingClientRect().height,width:t.getBoundingClientRect().width})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}},[]);return Object.values([c,d,E,L,z,W,$,Z]).every(function(t){return null!==t&""!==t})?r.a.createElement("div",{className:"timelineContainer",ref:et},r.a.createElement("div",{className:"chartContainer"},r.a.createElement(C,{data:c,scales:E,chartGeom:L,callbacks:{groups:function(t){return t.location}}})),r.a.createElement("div",{className:"chartContainer"},r.a.createElement(B,{graph:z,scales:E,curve:"bezier",chartGeom:L})),r.a.createElement("div",{className:"chartContainer"},r.a.createElement(B,{graph:z,scales:E,curve:"arc",chartGeom:L})),r.a.createElement("div",{className:"chartContainer"},r.a.createElement(N,{phylogeny:W,layout:k.TransmissionLayout,attributes:$,scales:E,chartGeom:L})),r.a.createElement("div",{className:"chartContainer"},r.a.createElement(N,{phylogeny:W,layout:k.RectangularLayout,attributes:$,scales:E,chartGeom:L}))):r.a.createElement("div",{className:"timelineContainer",ref:et})};n(49);var G=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(l,null),r.a.createElement(L,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[22,1,2]]]);
//# sourceMappingURL=main.8b0e49ac.chunk.js.map