{"version":3,"sources":["images/logo.png","components/Header.js","components/CollapsablePanel.js","utils/commonFunctions.js","components/CasesHistogram.js","styles/global.js","utils/transmissionLayout.js","utils/commonStyles.js","components/TransmissionGraph.js","components/TransmissionPanel.js","utils/dataParsers.js","utils/Graph.js","components/CheckBox.js","components/OptionBar.js","components/FigTreeComponent.js","components/App.js","serviceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","Header","react_default","a","createElement","className","style","float","margin","href","target","rel","src","logo","alt","width","marginTop","marginLeft","React","Component","panelContainerCollapsed","position","height","minHeight","transition","WebkitTransition","border","borderRadius","borderLeft","panelContainerExpanded","Object","objectSpread","panelTitle","css","cursor","fontWeight","fontSize","paddingLeft","color","ExpandToggle","_ref","title","callback","assign","onClick","Panel","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","expanded","_this2","panelStyles","borderColor","CollapsablePanel_ExpandToggle","setState","textAlign","display","child","childProps","onlyUnique","value","index","self","indexOf","CasesHistogram","drawEpiPlot","bind","assertThisInitialized","size","node","svg","d3","selectAll","remove","yAxisHeight","bottom","top","xScale","range","left","right","selectedDataTypes","nodeDataStatuses","forEach","selected","i","push","nodeDataSources","filteredData","cases","filter","d","metaData","dataType","yScale","nice","bins","domain","thresholds","ticks","dateOfSampling","binsForStableAxis","length","append","attr","concat","svgGroup","select","margins","options","arguments","undefined","rotate","xlab","ylab","xAxis","scale","yAxis","text","drawAxis","data","enter","x0","Math","max","x1","_this3","ref","global","fontFamily","textDecoration","fill","stroke","strokeWidth","shapeRendering","fillOpacity","TranmissionLayout","graph","bezier","nodes","getNodes","map","key","spacingDimension","nodeMap","Map","edges","getEdgeList","edge","source","getNode","bilinks","link","s","t","createClass","get","toConsumableArray","getEdge","heigthFunction","nodesFromData","getDataNode","clusters","getClusters","sort","b","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","cluster","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","externalNodes","externalNode","err","return","setSpacingDimension","children","getOutgoingEdges","toolTipCSS","zIndex","padding","backgroundColor","pointerEvents","visibility","toolTipCSSInverse","TransmissionGraph","drawTransPlot","updateNodeVisibility","updateEdgeVisibility","newOpacity","classSelector","duration","ease","edgeDataStatuses","edgeDataSources","replace","infoRef","infoRef2","layout","layOutNodes","scaleForAxis","pickyForceX","strength","pickXInit","initialize","pickyForceY","pickYInit","simulation","force","distance","links","getDataEdge","on","x","dataEdge","hoverText","getEdgeHtml","y","html","nodeRadius","active","alphaTarget","restart","fx","fy","dataNode","getNodeHtml","positionLink","positionNode","_this4","maxWidth","r","TransmissionPanel","components_TransmissionGraph","parseDate","parseCaseData","standardColumns","entry","id","keys","name","toLowerCase","parseEdgeData","Graph","nodeList","element","edgeList","edgeMap","traversalDirection","set","outString","_arr","_i","toISOString","substring","getEdges","removeEdge","delete","_arr2","_i2","getIncomingEdges","sourceNode","targetNode","addEdge","newEdge","newEdge2","taget","visited","traverse","currentNode","nodeToVisit","turnBack","CheckBox","paddingRight","type","readOnly","checked","status","OptionBar","nodeOptions","nodeDataCallback","CheckBox_CheckBox","toString","nodeStatus","edgeOptions","edgeDataCallback","edgeStatus","BurgerMenu","noOverlay","pageWrapId","outerContainerId","transmissionLayout","transmissionCallBack","FigTreeComponent","drawTree","rectangularLayout","FigTree","treeLayout","update","tree","Tree","parseNewick","treeString","treeSVG","document","getElementById","svgId","figTree","xAxisTitle","annotations","caseData","Date of Sampling","Location","Outcome","dataSource","annotateTips","setNodeLabels","addToolTip","nodeInfo","onClickBranch","reroot","hilightExternalNodes","onClickNode","annotateNodesFromTips","order","rootNode","App","addCases","newData","addNode","addEdges","getNodeFromKeyValuePair","byLocation","selectedCases","counter","resolved","selectSample","checkThatBox","checkThatBoxArray","stateKey","newState","n","Id","newSelectedCases","Promise","all","csv","then","_ref2","slicedToArray","lineList","unSampledNodes","epiLinks","allLinks","parsedLineList","parsedUnsampledNodes","parsedEpiLinks","parsedAllLinks","result","fetch","response","overflow","components_Header","OptionBar_OptionBar","CollapsablePanel","Boolean","window","location","hostname","match","ReactDOM","render","components_App","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5e1384c1.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.e67d1199.png\";","import React from 'react';\nimport logo from '../images/logo.png';\nimport '../styles/Header.css';\n\nclass Header extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"header\">\n\t\t\t\t<div style={{ float: 'left', margin: '10px' }}>\n\t\t\t\t\t<a href=\"http://artic.network\" target=\"_blank\" rel=\"noopener noreferrer\">\n\t\t\t\t\t\t<img src={logo} alt={'logo'} width=\"132\" />\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<h1 style={{ marginTop: '60px', marginLeft: '10px' }}>TRAPPER</h1>\n\t\t\t\t\t<h2 style={{ marginTop: '10px', marginLeft: '10px' }}>\n\t\t\t\t\t\tTransmission Reconstuction And Phylogenetics Promoting Early Response\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Header;\n","import React from 'react';\nimport { css } from 'glamor';\n\nconst panelContainerCollapsed = {\n\tposition: 'relative',\n\twidth: '98%',\n\theight: '30px', // collapsed\n\tminHeight: '30px', // collapsed\n\tmargin: '10px 10px 10px 10px',\n\ttransition: 'height 0.5s ease-out',\n\tWebkitTransition: 'height 0.5s ease-out',\n\tborder: '1px solid gray',\n\tborderRadius: '5px',\n\tborderLeft: '5px solid gray',\n};\n\nconst panelContainerExpanded = {\n\t...panelContainerCollapsed,\n\theight: '500px',\n\tminHeight: '500px',\n};\nexport const panelTitle = css({\n\tcursor: 'pointer',\n\tfontWeight: 'bold',\n\tfontSize: '1.3em',\n\tpaddingLeft: '20px',\n\tcolor: '#F0605C',\n});\nconst ExpandToggle = ({ title, callback }) => (\n\t<div {...panelTitle} onClick={callback}>\n\t\t{title}\n\t</div>\n);\n\nclass Panel extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\texpanded: false,\n\t\t};\n\t}\n\trender() {\n\t\tlet panelStyles = {\n\t\t\t...(this.state.expanded ? panelContainerExpanded : panelContainerCollapsed),\n\t\t\t...{ borderColor: '#D8D8D8' },\n\t\t};\n\t\treturn (\n\t\t\t<div style={panelStyles}>\n\t\t\t\t<ExpandToggle\n\t\t\t\t\ttitle={this.props.title}\n\t\t\t\t\tcallback={() => this.setState({ expanded: !this.state.expanded })}\n\t\t\t\t/>\n\n\t\t\t\t{this.state.expanded ? (\n\t\t\t\t\t<div style={{ textAlign: 'center' }}>\n\t\t\t\t\t\t<div display={'inline-block'}>{<this.props.child {...this.props.childProps} />}</div>\n\t\t\t\t\t</div>\n\t\t\t\t) : null}\n\t\t\t</div>\n\t\t);\n\t}\n}\nexport default Panel;\n","import * as d3 from 'd3v4';\n\nexport const drawAxis = (svgGroup, xScale, yScale, size, margins, options = { rotate: 0, xlab: '', ylab: '' }) => {\n\t//Make axis\n\tconst xAxis = d3\n\t\t.axisBottom()\n\t\t.scale(xScale)\n\t\t.ticks(10);\n\tconst yAxis = d3\n\t\t.axisLeft()\n\t\t.scale(yScale)\n\t\t.ticks(5);\n\t// draw Axis\n\tsvgGroup\n\t\t.append('g')\n\t\t.attr('class', 'x-axis axis')\n\t\t.attr('transform', `translate(0,${size[1] - margins.top - margins.bottom} )`)\n\t\t.call(xAxis)\n\t\t.selectAll('text')\n\t\t.attr('y', 0)\n\t\t.attr('x', 9)\n\t\t.attr('transform', `rotate(${options.rotate})`)\n\t\t.style('text-anchor', 'start');\n\t// Add the text label for the x axis\n\tsvgGroup\n\t\t.append('text')\n\t\t.attr('transform', `translate(${size[0] / 2},${size[1] - margins.top - margins.bottom + 30})`)\n\t\t.style('text-anchor', 'middle')\n\t\t.text(options.xlab);\n\tsvgGroup\n\t\t.append('g')\n\t\t.attr('class', 'y-axis axis')\n\t\t.attr('transform', `translate(${margins.left},0)`)\n\t\t.call(yAxis);\n\t// Add the text label for the Y axis\n\tsvgGroup\n\t\t.append('text')\n\t\t.attr('transform', 'rotate(-90)')\n\t\t.attr('y', margins.left - 45)\n\t\t.attr('x', 0 - size[1] / 2)\n\t\t.attr('dy', '1em')\n\t\t.style('text-anchor', 'middle')\n\t\t.text(options.ylab);\n};\n//https://stackoverflow.com/questions/1960473/get-all-unique-values-in-a-javascript-array-remove-duplicates\nexport const onlyUnique = (value, index, self) => {\n\treturn self.indexOf(value) === index;\n};\n// https://wsvincent.com/javascript-currying/\nexport const curry = (fn, ...args) =>{\n\treturn (fn.length <= args.length) ?\n\t  fn(...args) :\n\t  (...more) => curry(fn, ...args, ...more);\n\t  }\n  ","import React from 'react';\nimport * as d3 from 'd3v4';\nimport { drawAxis, onlyUnique } from '../utils/commonFunctions';\n\n// With help from https://bl.ocks.org/gcalmettes/95e3553da26ec90fd0a2890a678f3f69\n\nclass CasesHistogram extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.drawEpiPlot = this.drawEpiPlot.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.drawEpiPlot();\n\t}\n\tcomponentDidUpdate() {\n\t\tthis.drawEpiPlot();\n\t}\n\n\tdrawEpiPlot() {\n\t\tconst width = this.props.size[0];\n\t\tconst height = this.props.size[1];\n\t\tconst node = this.node;\n\n\t\tconst svg = d3.select(node).style('font', '10px sans-serif');\n\n\t\tsvg.selectAll('g').remove();\n\n\t\tconst yAxisHeight = height - this.props.margin.bottom - this.props.margin.top;\n\t\tconst xScale = this.props.xScale.range([this.props.margin.left, width - this.props.margin.left - this.props.margin.right])\n\n\t\t//filter\n\t\tconst selectedDataTypes=[];\n\t\tthis.props.nodeDataStatuses.forEach((selected,i)=>{\n\t\t\tif(selected){\n\t\t\t\tselectedDataTypes.push(this.props.nodeDataSources[i])\n\t\t\t}\n\t\t})\n\t\tconst filteredData=this.props.cases.filter(d=>selectedDataTypes.indexOf(d.metaData.dataType)>-1)\n\n\t\tconst yScale = d3\n\t\t\t.scaleLinear()\n\t\t\t.range([height - this.props.margin.top - this.props.margin.bottom, this.props.margin.bottom])\n\t\t\t.nice();\n\t\tconst bins = d3\n\t\t\t\t.histogram()\n\t\t\t\t.domain(xScale.domain())\n\t\t\t\t.thresholds(xScale.ticks(10))\n\t\t\t\t.value(d => d.dateOfSampling? d.dateOfSampling: d.metaData[\"Date of onset\"])(filteredData);\n\n\n\t\tconst binsForStableAxis = d3\n\t\t\t\t.histogram()\n\t\t\t\t.domain(xScale.domain())\n\t\t\t\t.thresholds(xScale.ticks(10))\n\t\t\t\t.value(d => d.dateOfSampling? d.dateOfSampling: d.metaData[\"Date of onset\"])(this.props.cases);\n\t\tyScale.domain([0, d3.max(binsForStableAxis, d => d.length)]);\n\n\t\tsvg.selectAll('g').remove();\n\t\t// do the drawing\n\t\tsvg.append('g').attr('transform', `translate(${this.props.margin.left},${this.props.margin.top})`);\n\n\t\tconst svgGroup = svg.select('g');\n\n\t\tdrawAxis(svgGroup, this.props.xScale, yScale, this.props.size, this.props.margin, { rotate: 45, xlab: '', ylab: '' });\n\n\t\tsvgGroup.append(\"g\")\n\t\t.attr(\"fill\", \"grey\")\n\t  \t.selectAll(\"rect\")\n\t  .data(bins)\n\t  .enter()\n\t  .append(\"rect\")\n\t\t.attr(\"x\", d => xScale(d.x0) + 1)\n\t\t.attr(\"width\", d => Math.max(0, xScale(d.x1) - xScale(d.x0) - 1))\n\t\t.attr(\"y\", d => yScale(d.length))\n\t\t.attr(\"height\", d => yScale(0) - yScale(d.length));\n\n\t\tsvgGroup.append(\"g\")\n                .attr(\"id\", \"y-axis-label\")\n                .attr(\"class\", \"axis-label\")\n                .attr(\"transform\", `translate(${this.props.margin.left},${this.props.margin.top})`)\n                .append(\"text\")\n                .attr(\"transform\", \"rotate(-90)\")\n                .attr(\"y\", 0-this.props.margin.left-10)\n                .attr(\"x\", 0 - (yAxisHeight / 2))\n                .attr(\"dy\", \"1em\")\n                .style(\"text-anchor\", \"middle\")\n                .text(\"Reported Cases\");\n\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<svg ref={node => (this.node = node)} width={this.props.size[0]} height={this.props.size[1]} />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default CasesHistogram;\n","import {css} from 'glamor';\n// import colours from \"./colours\";\n\n\ncss.global('body', {\n  \"fontFamily\": \"Lato\",\n})\n\ncss.global('a', {\n  textDecoration: \"none\",\n  color: \"#5097BA\",\n  cursor: \"pointer\",\n  fontWeight: 600,\n  fontSize: \"94%\"\n})\n\ncss.global('h1', {\n  \"fontWeight\": \"bold\",\n  \"fontSize\": \"2em\"\n})\n\ncss.global('h2', {\n  \"fontWeight\": \"bold\",\n  \"fontSize\": \"1.5em\"\n})\n\ncss.global('div, p', {\n  \"fontWeight\": \"normal\",\n  \"fontSize\": \"1em\"\n})\n\ncss.global('.dc-chart .axis path, .axis line', {\n  fill: 'none',\n  stroke: '#000',\n  strokeWidth: 1,\n  shapeRendering: 'auto'\n})\n\ncss.global('.axis text', {\n    fontSize: '12px'\n})\n\ncss.global('.brush rect.extent', {\n    fill: 'steelblue',\n    fillOpacity: .125\n})\n\ncss.global('.brush .resize path', {\n    fill: '#eee',\n    stroke: '#666'\n})\n","import * as d3 from 'd3v4';\nexport class TranmissionLayout{\n    constructor(graph,bezier=true) {\n        this.graph=graph\n        this.nodes=this.graph.getNodes().map(node=>  {return{\"key\":node.key,\"height\":null,\"spacingDimension\":null}})\n        this.nodeMap = new Map(this.nodes.map(node => [node.key, node]));\n        this.edges = this.graph.getEdgeList().map(edge=>{\n                                                        return{\"key\":edge.key,\n                                                            \"source\":this.getNode(edge.source.key),\n                                                            \"target\":this.getNode(edge.target.key)};\n                                                        });\n        // adding intermediate nodes for Bezier curves\n        this.bilinks=[];\n        // https://bl.ocks.org/mbostock/4600693\n        if(bezier){\n            this.edges.forEach((link)=> {\n                var s = link.source,\n                    t = link.target,\n                    i = {}; // intermediate node\n                this.nodes.push(i);\n                this.edges.push({source: s, target: i}, {source: i, target: t});\n                this.bilinks.push([s, i, t,{\"key\":link.key}]);\n              });\n\n        }\n\n    };\n    \n    getNode(key){\n        return this.nodeMap.get(key);\n    }\n    getDataNode(key){\n        return this.graph.getNode(key);\n    }\n    getOutgoingEdges(node){\n        return [...this.edges.filter(edge=>edge.source===node)]\n    }\n    getDataEdge(key){\n        return this.graph.getEdge(key);\n    }\n    layOutNodes(heigthFunction){\n        const nodesFromData=this.nodes.filter(node=>node.key);\n        nodesFromData.forEach(node=>node.height=heigthFunction(this.getDataNode(node.key)))\n        // each time we go back from going fowards count an external tip.\n        // set height based on that.\n        const clusters = this.graph.getClusters();\n        // Set y of external nodes\n        clusters.sort((a,b)=>{\n            if(b.nodes.length===1&a.nodes.length>1){\n                return -1;\n            }else{\n                return(d3.min(a.nodes,d=>heigthFunction(d))-d3.min(b.nodes,d=>heigthFunction(d)))\n            }\n   \n        });\n        let i=1;\n        for(const cluster of clusters){\n            for(const externalNode of cluster.externalNodes){\n                const plotNode=this.getNode(externalNode.key)//plot node\n                plotNode.spacingDimension=i;\n                i++;\n            }\n        }\n        // fix overplotting\n        // Set the y of internal nodes as the mean of their children.\n        nodesFromData.forEach(node=>this.setSpacingDimension(node));\n    }\n\n    setSpacingDimension(node){\n        if(node.spacingDimension){\n            return;\n        }else{\n            const children = this.getOutgoingEdges(node).map(edge=>edge.target);\n            children.forEach(child=>this.setSpacingDimension(child))\n            node.spacingDimension=d3.mean(children,child=>child.spacingDimension)\n        }\n    }\n\n}","import { css } from 'glamor';\n\nexport const chartTitleCSS = css({\n  textAlign: \"center\",\n  \"fontWeight\": \"bold\",\n  \"fontSize\": \"1em\"\n});\n\nexport const toolTipCSS = css({\n    zIndex: 20,\n    position: \"absolute\",\n    borderRadius: \"5px\",\n    padding: \"5px\",\n    margin: \"auto\",\n    backgroundColor: \"hsla(0,0%,0%,.8)\",\n    color: \"white\",\n    pointerEvents: \"none\",\n    visibility: \"hidden\",\n    fontSize: \"14px\",\n    fontWeight: \"700\"\n});\n\nexport const toolTipCSSInverse = css({\n  zIndex: 20,\n  position: \"absolute\",\n  borderRadius: \"5px\",\n  padding: \"5px\",\n  margin: \"auto\",\n  backgroundColor: \"rgb(245,245,245)\",\n  color: \"hsla(0,0%,0%,.8)\",\n  pointerEvents: \"none\",\n  visibility: \"hidden\",\n  fontSize: \"14px\",\n  fontWeight: \"700\"\n});\n","import React from 'react';\nimport * as d3 from 'd3v4';\nimport {TranmissionLayout} from \"../utils/transmissionLayout\"\nimport { toolTipCSS, toolTipCSSInverse } from '../utils/commonStyles';\nimport '../styles/TransmissionGraph.css'; // TODO\nimport '../styles/commonPlotStyle.css'\n\n\nclass TransmissionGraph extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.drawTransPlot = this.drawTransPlot.bind(this);\n\t\tthis.updateNodeVisibility=this.updateNodeVisibility.bind(this);\n\t\tthis.updateEdgeVisibility=this.updateEdgeVisibility.bind(this);\n\t}\n\tcomponentDidMount() {\n\t\tthis.drawTransPlot();\n\t}\n\tcomponentDidUpdate() {\n\t\tthis.updateNodeVisibility();\n\t\tthis.updateEdgeVisibility();\n\n\t\t\t}\n\n\tupdateNodeVisibility(){\n\t\tthis.props.nodeDataStatuses.forEach((selected,i)=>{\n\t\t\tconst newOpacity = selected? 1:0;\n\t\t\tconst classSelector=`.${this.props.nodeDataSources[i]}`\n\t\t\td3.selectAll(`${classSelector}`)\n\t\t\t\t.transition()\n\t\t\t\t.duration(300)\n\t\t\t\t.ease(d3.easeLinear)\n\t\t\t\t.style(\"opacity\", newOpacity);\n\t\n\t  })\n\t}\n\tupdateEdgeVisibility(){\n\t\tthis.props.edgeDataStatuses.forEach((selected,i)=>{\n\t\t\tconst newOpacity = selected? 1:0;\n\t\t\tconst classSelector=`.${this.props.edgeDataSources[i].replace(/ /g, '-')}`\n\t\t\td3.selectAll(`${classSelector}`)\n\t\t\t\t.transition()\n\t\t\t\t.duration(300)\n\t\t\t\t.ease(d3.easeLinear)\n\t\t\t\t.style(\"opacity\", newOpacity);\n\t\n\t  })\n\t}\n\n\n\tdrawTransPlot() {\n\t\tconst node = this.node;\n\t\tconst infoRef = this.infoRef;\n\t\tconst infoRef2 = this.infoRef2;\n\n\n\n\t\tfunction handleMouseMove(d, i) {\n\t\t\tconst left = d.x < 0.5 * xScale.range()[1] ? `${xScale.range()[0] + d.x}px`:'';\n\t\t\tconst right = d.x > 0.5 * xScale.range()[1] ? `${xScale.range()[1] - d.x}px` : '';\n\t\t\tconst dataNode = layout.graph.getNode(d.key);\n\t\t\tconst hoverText = layout.graph.getNodeHtml(dataNode);\n\t\t\td3.select(infoRef)\n\t\t\t\t.style('left', left)\n\t\t\t\t.style('right', right)\n\t\t\t\t.style('top', `${d.y}px`)\n\t\t\t\t.style('visibility', 'visible')\n\t\t\t\t.html(hoverText);\n\t\t}\n\t\tfunction handleMouseOut() {\n\t\t\td3.select(infoRef).style('visibility', 'hidden');\n\t\t}\n\n\t\tfunction handleMouseMoveLink(d, i) {\n\t\t\tconst left = d[1].x < 0.5 * xScale.range()[1] ? `${xScale.range()[0] + d[1].x}px`:'';\n\t\t\tconst right = d[1].x > 0.5 * xScale.range()[1] ? `${xScale.range()[1] - d[1].x}px` : '';\n\t\t\tconst dataEdge = layout.graph.getEdge(d[3].key);\n\t\t\tconst hoverText = layout.graph.getEdgeHtml(dataEdge);\n\t\t\td3.select(infoRef2)\n\t\t\t\t.style('left', left)\n\t\t\t\t.style('right', right)\n\t\t\t\t.style('top', `${d[1].y}px`)\n\t\t\t\t.style('visibility', 'visible')\n\t\t\t\t.html(hoverText);\n\t\t}\n\t\tfunction handleMouseOutLink() {\n\t\t\td3.select(infoRef2).style('visibility', 'hidden');\n\t\t}\n\n\n\t\tconst width = this.props.size[0];\n\t\tconst height = this.props.size[1];\n\t\tconst svg = d3.select(node).style('font', '10px sans-serif');\n\t\tsvg.selectAll('g').remove();\n\t\tsvg.append('g').attr('transform', `translate(${this.props.margin.left},${this.props.margin.top})`);\n\t\tconst svgGroup = svg.select('g');\n\n\t\tconst layout = new TranmissionLayout(this.props.data);\n\t\tlayout.layOutNodes(d=>d.metaData['Date of onset']);\n\n\t\t// layout.layOutNodes(d=>d.dateOfSampling);\n\t\tconst xScale=d3\n\t\t\t\t\t.scaleLinear()\n\t\t\t\t\t.domain(d3.extent(layout.nodes,d=>d.height))\n\t\t\t\t\t.range([this.props.margin.left, width - this.props.margin.left - this.props.margin.right])\n\t\t\t\t\t.nice()\n\t\tconst yScale = d3\n\t\t\t\t\t.scaleLinear()\n\t\t\t\t\t.domain(d3.extent(layout.nodes,d=>d.spacingDimension))\n\t\t\t\t\t.range([height - this.props.margin.top - this.props.margin.bottom, this.props.margin.bottom])\n\t\t\t\t\t.nice();\n\n\t\tconst scaleForAxis=this.props.xScale.range([this.props.margin.left, width - this.props.margin.left - this.props.margin.right]);\n\t\tconst xAxis = d3.axisBottom().scale(scaleForAxis);\n\n\t\tsvgGroup\n\t\t\t.append('g')\n\t\t\t.attr('class', 'x-axis axis')\n\t\t\t.attr('transform', `translate(0,${(height - this.props.margin.top -this.props.margin.bottom +25)} )`)\n\t\t\t.call(xAxis)\n\t\t\t.selectAll('text')\n\t\t\t.attr('y', 0)\n\t\t\t.attr('x', 9)\n\t\t\t.attr('transform', `rotate(${45})`)\n\t\t\t.style('text-anchor', 'start');\n\n\n\n\t\tconst nodeRadius=7;\n\n\t\tconst pickyForceX=d3.forceX(d=>xScale(d.height)).strength(0.5);\n\t\tconst pickXInit = pickyForceX.initialize;\n\t\tpickyForceX.initialize=function(nodes){\n\t\t\tpickXInit(nodes.filter(node=>node.key))\n\t\t}\n\n\t\tconst pickyForceY=d3.forceY(d=>yScale(d.spacingDimension)).strength(0.5);\n\t\tconst pickYInit = pickyForceY.initialize;\n\t\tpickyForceY.initialize=function(nodes){\n\t\t\tpickYInit(nodes.filter(node=>node.key))\n\t\t}\n\n\n\n\t\tconst simulation = d3.forceSimulation()\n\t\t\t\t\t\t.force(\"collide\",d3.forceCollide(d=>nodeRadius))\n\t\t\t\t\t\t.force(\"xPosition\",pickyForceX)\n\t\t\t\t\t\t.force(\"yPosition\",pickyForceY)\n\t\t\t\t\t\t.force(\"center\",d3.forceCenter(width/2,height/2))\n\t\t\t\t\t\t.force(\"charge\", d3.forceManyBody().strength(0.07))\n\t\t\t\t\t\t.force(\"link\", d3.forceLink().distance(5).strength(0.5));\n\n\n\t\n\t\tconst links = svgGroup.append('g')\n\t\t\t\t\t\t.selectAll(\".link\")\n\t\t\t\t\t\t.data(layout.bilinks)\n\t\t\t\t\t\t.enter().append(\"path\")\n\t\t  \t\t\t\t.attr(\"class\", d=>`${layout.getDataEdge(d[3].key).metaData.dataType.replace(/ /g, '-')} link`)\n    \t\t\t\t\t.style(\"stroke\", \"#bbb\")  // colour the line\n\t\t\t\t\t\t.style(\"stroke-width\",3)\n\t\t\t\t\t\t.style(\"fill\",'none')\n\t\t\t\t\t\t.on('mouseover', handleMouseMoveLink)\n\t\t\t\t\t\t.on('mouseout', handleMouseOutLink)\n\t\t\n\t\tconst nodes = svgGroup.append('g')\n\t\t\t.selectAll(\"circle\")\n\t\t\t.data(layout.nodes.filter(d=>d.key))\n\t\t\t.enter()\n\t\t\t.append(\"circle\")\n\t\t\t.attr(\"r\",d=>layout.getDataNode(d.key).metaData.dataType===\"Inferred\"?nodeRadius-1.5:nodeRadius)\n\t\t\t.attr(\"class\",d=>`${layout.getDataNode(d.key).metaData.dataType} transmission-node`)\n\t\t\t.call(d3.drag()\n\t\t\t.on(\"start\", dragstarted)\n\t\t\t.on(\"drag\", dragged)\n\t\t\t.on(\"end\", dragended))\n\t\t\t.on('mouseover', handleMouseMove)\n\t\t\t.on('mouseout', handleMouseOut);\n\t\t  \n\t\tsimulation\n\t\t  .nodes(layout.nodes)\n\t\t  .on(\"tick\", ticked);\n\n\t\tsimulation.force(\"link\")\n\t\t  .links(layout.edges);\n\n\t\t  // hide nodes that we don't want\n\t\tthis.updateNodeVisibility();\n\t\t// this.updateEdgeVisibility();\n\t\t\n\t\t//   svgGroup.selectAll()\n\n\t\t  function ticked() {\n\t\t\tlinks.attr(\"d\", positionLink);\n\t\t\tnodes.attr(\"transform\", positionNode);\n\t\t  }\n\t\t\n\t\t  function positionLink(d) {\n\t\t\tconst pathString = `M${d[0].x},${d[0].y}S${d[1].x},${d[1].y} ${d[2].x},${d[2].y}`;\n\t\t\treturn pathString;\n\t\t  }\n\t\t  \n\t\t  function positionNode(d) {\n\t\t\treturn \"translate(\" + d.x + \",\" + d.y + \")\";\n\t\t  }\n\t\t  \n\t\t  function dragstarted(d) {\n\t\t\tif (!d3.event.active) simulation.alphaTarget(0.5).restart();\n\t\t\td.fx = d.x;\n\t\t\t d.fy = d.y;\n\t\t  }\n\t\t  \n\t\t  function dragged(d) {\n\t\t\td.fx = d3.event.x;\n\t\t\t d.fy = d3.event.y;\n\t\t  }\n\t\t  \n\t\t  function dragended(d) {\n\t\t\tif (!d3.event.active) simulation.alphaTarget(0);\n\t\t\td.fx = null;\n\t\t\t d.fy = null;\n\t\t  }\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t<div\n\t\t\t\t\t{...toolTipCSS}\n\t\t\t\t\tstyle={{ maxWidth: this.props.size[0] / 2 }}\n\t\t\t\t\tref={r => {\n\t\t\t\t\t\tthis.infoRef = r;\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t{...toolTipCSSInverse}\n\t\t\t\t\tstyle={{ maxWidth: this.props.size[0] / 2 }}\n\t\t\t\t\tref={r => {\n\t\t\t\t\t\tthis.infoRef2 = r;\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t<svg ref={node => (this.node = node)} width={this.props.size[0]} height={this.props.size[1]} />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default TransmissionGraph;\n","import React from 'react';\nimport TransmissionGraph from './TransmissionGraph';\n\nclass TransmissionPanel extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\t// subsetData: false,\n\t\t};\n\t\t// this.subsetData = this.subsetData.bind(this);\n\t}\n\t// subsetData() {\n\t// \tthis.setState({ subsetData: !this.state.subsetData });\n\t// }\n\n\trender() {\n\t\t\n\t\t\treturn (\n\t\t\t\t<div>\n\t\t\t\t\t<TransmissionGraph {...this.props} />>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t}\n\n\nexport default TransmissionPanel;\n","import * as d3 from 'd3v4';\n\nconst  parseDate = d3.timeParse(\"%Y-%m-%d\")\n\nexport const  parseCaseData=(d)=>{\n    const standardColumns =[\"Id\",\"Date of sampling\"]\n    const entry = {\n        id:d['Id'],\n        dateOfSampling:parseDate(d['Date of sampling']),\n        metaData:{},\n    }\n        Object.keys(d).forEach(name=>{\n            if(standardColumns.indexOf(name)===-1){\n                if(name.toLowerCase().indexOf(\"date\")>-1){\n                    entry.metaData[name]=parseDate(d[name]);\n                }else{\n                   entry.metaData[name]=d[name];\n                }\n            }\n    });\n    return entry;\n}\n\nexport const parseEdgeData=(d)=>{\n    const standardColumns =[\"Source\",\"Target\"]\n    const entry = {\n        source:d['Source'],\n        target:d['Target'],\n        metaData:{},\n    }\n\n        Object.keys(d).forEach(name=>{\n            if(standardColumns.indexOf(name)===-1){\n                entry.metaData[name]=d[name];\n            }\n    });\n    return entry;\n}\nexport const readData =(fileName,formatter,callback)=>{\n        d3.csv(fileName,(data)=>{\n                const parsedData = data.map(d=>formatter(d));\n                callback(parsedData);\n\n      });\n}\n\n","import * as d3 from 'd3v4'\nexport class Graph{\n    constructor(nodes=[],edges=[]) {\n           this.nodeList =nodes;\n           this.nodeList.forEach(element => {\n               element.key=Symbol();\n           });\n           this.nodeMap = new Map(this.nodeList.map(node => [node.key, node]));\n        this.edgeList = edges;\n        this.edgeList.forEach(element => {\n            element.key=Symbol();\n        });\n        this.edgeMap = new Map(this.edgeList.map(edge => [edge.key, edge]));   \n        // This is used in identifying terminal tips  \n        this.traversalDirection=\"forward\"\n        \n    };\n\n    addNode(node){\n        if(Object.keys(node).indexOf(\"key\")===-1){\n            node.key=Symbol();\n        }\n        this.nodeList.push(node);\n        this.nodeMap.set(node.key,node);\n    }\n    addEdge(edge){\n        if(Object.keys(edge).indexOf(\"key\")===-1){\n            edge.key=Symbol();\n        }        \n        this.edgeList.push(edge);\n        this.edgeMap.set(edge.key,edge);\n    }\n    getNode(key){\n        return this.nodeMap.get(key);\n    }\n    getNodeFromKeyValuePair(key,value){\n        return this.nodeList.filter(node=>node[key]===value)[0]\n    }\n    getNodeHtml(node){\n        // const formatDate=d3.timeFormat(\"%Y-%m-%d\")\n        let outString = `${node.id} </br>`\n        // for(const key of Object.keys(node)){\n        //     if(node[key]){\n        //         if(key!==\"id\"&& key!==\"metaData\"&&key!==\"key\"){\n        //             if(key.toLowerCase().indexOf(\"date\")>-1){\n        //                 outString = `${outString}${key}: ${node[key].toISOString().substring(0, 10)}</br>`;\n        //                 }else{\n        //                 outString = `${outString}${key}: ${node[key]}</br>`;\n        //                 }            \n        //             }\n        //     }\n        // }\n    \n        for(const key of Object.keys(node.metaData)){\n            if(key.toLowerCase().indexOf(\"date\")>-1){\n            outString = `${outString}${key}: ${node.metaData[key].toISOString().substring(0, 10)}</br>`;\n            }else{\n            outString = `${outString}${key}: ${node.metaData[key]}</br>`;\n            }\n        }\n        return outString;\n    }\n\n    getNodes(){\n        return this.nodeList;\n    }\n    removeNode(node,preserveEdges=false){\n        //remove edges\n        const edges = this.getEdges(node);\n        edges.forEach(edge=>this.removeEdge(edge))\n\n        const key=node.key\n        this.nodeList=this.nodeList.filter(node=>node.key!==key);\n        this.nodeMap.delete(key)\n    }\n\n    getEdge(key){\n        return this.edgeMap.get(key);\n    }\n    getEdgeHtml(edge){\n        // const formatDate=d3.timeFormat(\"%Y-%m-%d\")\n        let outString = `Source:${edge.source.id} </br> Target: ${edge.target.id}</br>`;\n        for(const key of Object.keys(edge.metaData)){\n            if(key.toLowerCase().indexOf(\"date\")>-1){\n            outString = `${outString}${key}: ${edge.metaData[key].toISOString().substring(0, 10)}</br>`;\n            }else{\n            outString = `${outString}${key}: ${edge.metaData[key]}</br>`;\n            }\n        }\n        return outString;\n    }\n    getIncomingEdges(node){\n       return [...this.edgeList.filter(edge=>edge.target===node)]\n    }\n    getOutgoingEdges(node){\n        return [...this.edgeList.filter(edge=>edge.source===node)]\n    }\n    getEdges(node){\n        return[...this.getOutgoingEdges(node),...this.getIncomingEdges(node)]\n    }\n    getEdgeList(){\n        return this.edgeList;\n    }\n    removeEdge(edge){\n        const key=edge.key\n        this.edgeList=this.edgeList.filter(edge=>edge.key!==key);\n        this.edgeMap.delete(key)\n    }\n\n    makeEdge(sourceNode,targetNode){\n        this.addEdge({source:sourceNode,target:targetNode})\n    }\n    insertNode(node,edge){\n        const newEdge = {source:edge.source,target:node}\n        const newEdge2 = {source:node,target:edge.taget}\n\n        this.removeEdge(edge)\n\n        this.addEdge(newEdge)\n        this.addEdge(newEdge2)\n    }\n\n    getClusters(){\n        this.nodeList.forEach(node=>node.visited=false)\n        let clusters=[];\n        this.traversalDirection=\"forward\";\n        this.nodeList.forEach(node=>{\n            if(!node.visited){\n            const cluster={nodes:[node],\n                            externalNodes:[]}\n            node.visited=true;\n            this.getEdges(node).forEach(edge=>\n                this.traverse(node,edge,cluster))\n                //If this is a on node cluster then add the node as\n                // an external as well\n                if(cluster.nodes.length===1){\n                    if(cluster.externalNodes.length===0){\n                        cluster.externalNodes.push(node);\n                    }\n                }\n             clusters.push(cluster);\n            }\n        })\n        return clusters;\n\n    }\n\n    traverse(currentNode,edge,cluster){\n        let nodeToVisit;\n        let turnBack=false;\n\n        if(currentNode===edge.source){\n             nodeToVisit = edge.target;\n            this.traversalDirection=\"forward\"\n        }else{\n            nodeToVisit= edge.source\n            if(this.traversalDirection===\"forward\"){\n                turnBack=true;\n            }\n            this.traversalDirection=\"backward\"\n        }\n        if(nodeToVisit.visited){\n            if(turnBack){\n                cluster.externalNodes.push(currentNode);\n            }\n            return;\n        }else{\n            nodeToVisit.visited=true;\n            cluster.nodes.push(nodeToVisit);\n            this.getEdges(nodeToVisit).forEach(edge=>this.traverse(nodeToVisit,edge,cluster));\n        }\n    }\n}","import React, { Component } from 'react';\nimport \"../styles/temporary.css\"\nexport const CheckBox=(props)=>{\nreturn(\n<div>\n    <span style={{ paddingRight: '10px' }}> {props.title} :</span>\n\t\t\t\t\t<label className=\"switch\">\n\t\t\t\t\t\t<input type=\"checkbox\" readOnly onClick={props.callback} checked={props.status} />\n\t\t\t\t\t\t<span className=\"slider round\" />\n\t\t\t\t\t</label>\n</div>\n)\n}\n","import React from 'react';\nimport { push as Menu } from 'react-burger-menu'\nimport{CheckBox} from \"./CheckBox\"\nimport \"../styles/menu.css\"\n \nexport const OptionBar=(props)=>  {\n    const nodeOptions=props.nodeOptions.map((d,i)=>{\n      const callback=props.nodeDataCallback(i);\n     return (<CheckBox key={i.toString()} title={d} status={props.nodeStatus[i]} callback={callback}/>);\n    })\n    const edgeOptions = props.edgeOptions.map((d,i)=>{\n      const callback=props.edgeDataCallback(i);\n\n      return (<CheckBox key={i.toString()} title={d} status={props.edgeStatus[i]} callback={callback}/>);\n     })\n    return (\n      <Menu left noOverlay push pageWrapId={ \"page-wrap\" } outerContainerId={ \"outer-container\" } >\n      <h4>Data sources</h4>\n      <h5>Cases:</h5>\n      {nodeOptions}\n      <h5>Transmission events</h5>\n      {edgeOptions}\n      <h4>Color options</h4>\n      <h5>TODO</h5>\n      <h4>Tree</h4>\n      <CheckBox title={\"Transmission Layout\"} status={props.transmissionLayout} callback={props.transmissionCallBack}/>\n      </Menu>\n    );\n}\n","import React, { Component } from 'react';\nimport * as d3 from 'd3v4';\nimport { Tree,FigTree,transmissionLayout,rectangularLayout } from 'figtree';\nimport \"../styles/figtree.css\"\n\n\n/**\n * A component that takes in a tree a fig tree settings object, and \n * an id for the svg and draws the tree. easy peasy\n */\n\nclass FigTreeComponent extends Component {\n  constructor(props) {\n\t\tsuper(props);\n\n  this.drawTree = this.drawTree.bind(this);\n  }\n  componentDidMount() {\n    this.drawTree()\n  }\n  componentDidUpdate(){\n    const layout = this.props.transmissionLayout? transmissionLayout:rectangularLayout;\n    this.state.FigTree.treeLayout = layout;    \n    this.state.FigTree.update()\n  }\n  \n  drawTree(){\n    const tree = Tree.parseNewick(this.props.treeString);\n    const treeSVG = document.getElementById(this.props.svgId);\n    const figTree = new FigTree(treeSVG, tree, { top: 10, bottom: 60, left: 10, right: 50}, { nodeRadius: 4,   xAxisTitle: \"\"});\n    d3.select(treeSVG).selectAll(\".internal-node\").attr(\"display\",\"none\")\n    d3.select(treeSVG).selectAll(\".axis\").remove()\n\n    const annotations= {};\n    \n    this.props.caseData.getNodes().forEach(node=>{\n      if(tree.nodes.map(node=>node.name).indexOf(node.id)>-1){\n      annotations[node.id]={\n       \"Date of Sampling\":node.dateOfSampling?node.dateOfSampling.toISOString().substring(0, 10):\"\",\n       \"Location\":node.metaData.Location? node.metaData.Location:\"\",\n       \"Outcome\":node.metaData.Outcome? node.metaData.Outcome:\"\",\n       \"dataSource\":node.metaData.dataSource? node.metaData.dataSource:\"\",\n      }\n    }\n    })\n   \n    tree.annotateTips(annotations);\n\n    figTree.setNodeLabels();\n    figTree.addToolTip('.node', FigTree.nodeInfo);\n    \n    figTree.onClickBranch(FigTree.reroot);\n    figTree.hilightExternalNodes();\n    figTree.onClickNode(FigTree.rotate);\n\n    tree.annotateNodesFromTips(\"Location\");\n    tree.order(tree.rootNode,false)\n\n    if(this.props.transmissionLayout){\n    figTree.treeLayout = transmissionLayout;\n    }\n\n\n\n\n\n\n\n    figTree.update();\n\n    this.setState({FigTree:figTree,Tree:tree})\n  \n  }\n\n\n\n\n  render() {\n    return (\n      <div>\n      <div id=\"tooltip\"></div>\n\n          <svg id={this.props.svgId} width={this.props.width} height={this.props.height} />\n          </div>\n    );\n  }\n}\n\nexport default FigTreeComponent;\n","import React, { Component } from 'react';\nimport Header from './Header';\nimport Panel from './CollapsablePanel';\nimport CasesHistogram from './CasesHistogram';\n//Styles from Rampart\nimport '../styles/global'; // sets global CSS\nimport '../styles/fonts.css'; // sets global fonts\nimport '../styles/temporary.css'; // TODO\nimport TransmissionPanel from './TransmissionPanel';\nimport {parseCaseData,  parseEdgeData} from \"../utils/dataParsers.js\";\nimport {Graph} from \"../utils/Graph\";\nimport {OptionBar} from \"./OptionBar\"\nimport \"../styles/App.css\"\nimport {onlyUnique} from \"../utils/commonFunctions\";\nimport {csv}  from 'd3-fetch'\nimport FigTreeComponent from \"./FigTreeComponent\"\nimport * as d3 from 'd3v4';\n\nclass App extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = { byLocation: false, \n\t\t\tselectedCases: [], \n\t\t\tcounter: 0 ,\n\t\t\tdata:new Graph(),\n\t\t\ttransmissionLayout:false,\n\t\t\tresolved:false,\n\t\t\t// use a map here instead of 2 arrays?\n\t\t\tnodeDataSources:[],\n\t\t\tnodeDataStatuses:[]};\n\t\t// this.addTree = this.addTree.bind(this);\n\t\tthis.selectSample = this.selectSample.bind(this);\n\t\tthis.addCases=this.addCases.bind(this);\n\t\tthis.addEdges=this.addEdges.bind(this);\n\t\tthis.checkThatBox=this.checkThatBox.bind(this);\n\t\tthis.checkThatBoxArray=this.checkThatBoxArray.bind(this);\n\t}\n\t\n\taddCases = (newData)=>{\n\t\tnewData.forEach(node=>{\n\t\t\tthis.state.data.addNode(node)\n\t\t})\n\t\tthis.setState({xScale:d3\n\t\t\t.scaleTime()\n\t\t\t.domain(d3.extent(newData, d => d.dateOfSampling? d.dateOfSampling: d.metaData[\"Date of onset\"]))\n\t\t\t.nice()})\n\t}\n\taddEdges = newData=>{\n\t\tnewData.forEach(edge=>{\n\t\t\tconst source=this.state.data.getNodeFromKeyValuePair(\"id\",edge.source)\n\t\t\tconst target = this.state.data.getNodeFromKeyValuePair(\"id\",edge.target)\n\t\t\tthis.state.data.addEdge({source:source,\n\t\t\t\t\t\t\t\t\ttarget:target,\n\t\t\t\t\t\t\t\t\tmetaData:edge.metaData})\n\t})\n}\n\tcheckThatBox(stateKey){\n\t\tconst checkThisOne=()=>{\n\t\t\tconst newState={};\n\t\t\t newState[stateKey]=!this.state[stateKey];\n\t\t\tthis.setState(newState)\n\t\t}\n\t\treturn(checkThisOne)\n\t}\n\tcheckThatBoxArray(stateKey){\n\t\tconst self=this;\n\t\tconst thisIndexPlease=(i)=>{\n\t\t\tconst checkIt=()=>{\n\t\t\t\tconst newState={};\n\t\t\t\tnewState[stateKey]=self.state[stateKey];\n\t\t\t\tnewState[stateKey][i]=!self.state[stateKey][i]\n\t\t\t\tself.setState(newState)\n\t\t\t}\n\t\t\treturn(checkIt)\n\t\t}\n\t\treturn(thisIndexPlease)\n\t}\n\n\n\tselectSample(node) {\n\t\tconst selectedCases = this.state.selectedCases;\n\t\tif (selectedCases.map(n => n.Id).indexOf(node.Id) > -1) {\n\t\t\t//remove it\n\t\t\tconst newSelectedCases = selectedCases.filter(x => x !== node);\n\t\t\tthis.setState({ selectedCases: newSelectedCases });\n\t\t} else {\n\t\t\t//add it\n\n\t\t\tselectedCases.push(node);\n\t\t\tthis.setState({ selectedCases: selectedCases });\n\t\t}\n\t}\n\t\n\tcomponentDidMount() {\n\t\t// Wait to render until the data is read\n\t\tconst prefix = process.env.NODE_ENV === 'development' ? 'http://localhost:3001/' : '';\n\t\tPromise.all([\n\t\t\tcsv(`${prefix}data/lineList.csv`),\n\t\t\tcsv(`${prefix}data/UnsampledTrueCases.csv`),\n\t\t\tcsv(`${prefix}data/epiContacts.csv`),\n\t\t\tcsv(`${prefix}data/PerfectGeneticLinks.csv`)\n\t\t]).then(([lineList,unSampledNodes,epiLinks,allLinks])=>{\n\t\t\tconst parsedLineList=lineList.map(d=>parseCaseData(d));\n\t\t\tthis.addCases(parsedLineList);\n\n\t\t\tconst parsedUnsampledNodes=unSampledNodes.map(d=>parseCaseData(d));\n\t\t\tthis.addCases(parsedUnsampledNodes);\n\n\t\t\tconst parsedEpiLinks=epiLinks.map(d=>parseEdgeData(d));\n\t\t\tthis.addEdges(parsedEpiLinks);\n\n\t\t\tconst parsedAllLinks=allLinks.map(d=>parseEdgeData(d));\n\t\t\tthis.addEdges(parsedAllLinks);\n\n\t\t\treturn true\n\t\t}).then((result)=>{\n\t\t\tfetch(`${prefix}data/sampledTree.phy`)\n\t\t\t.then(response=>response.text()\n\t\t\t\t\t\t\t.then(text=>{\n\t\t\t\t\t\t\t\tthis.setState({treeString:text})\n\t\t\t\t\t\t\t}))\n\t\t\treturn true;\n\t\t}).then((result)=>{\n\t\t\tthis.setState({nodeDataSources:this.state.data.getNodes().map(d=>d.metaData.dataType).filter(onlyUnique)});\n\t\t\tthis.setState({nodeDataStatuses:this.state.data.getNodes().map(d=>d.metaData.dataType).filter(onlyUnique).map(x=>true)})\n\t\t\tthis.setState({edgeDataSources:this.state.data.getEdgeList().map(d=>d.metaData.dataType).filter(onlyUnique)});\n\t\t\tthis.setState({edgeDataStatuses:this.state.data.getEdgeList().map(d=>d.metaData.dataType).filter(onlyUnique).map(x=>true)});\n\t\t\treturn true\n\t\t}).then((result)=>{\n\t\t\tthis.setState({resolved:result})\n\t\t})\n\t}\n\n\n\n\n\trender() {\n\t\tif (!this.state.resolved) {\n\t\t\treturn <div>Loading...</div>;\n\t\t  } else {\n\t\t\treturn (\n\t\t\t<div id=\"outer-contanier\" style={{overflow: 'auto', height:'500%'}} >\n\t\t\t\t<Header />\n\t\t\t\t<OptionBar \n\t\t\t\tnodeOptions={this.state.nodeDataSources}\n\t\t\t\tnodeStatus = {this.state.nodeDataStatuses}\n\t\t\t\tedgeOptions={this.state.edgeDataSources}\n\t\t\t\tedgeStatus ={this.state.edgeDataStatuses}\n\t\t\t\tnodeDataCallback ={this.checkThatBoxArray(\"nodeDataStatuses\")}\n\t\t\t\tedgeDataCallback ={this.checkThatBoxArray(\"edgeDataStatuses\")}\n\t\t\t\ttransmissionLayout={this.state.transmissionLayout}\n\t\t\t\ttransmissionCallBack={this.checkThatBox(\"transmissionLayout\")}\n\t\t\t\t/>\n\t\t\t\t\n\n\t\t\t\t<div className=\"Panels\" id=\"page-wrap\">\n\t\t\t\t<Panel\n\t\t\t\t\ttitle=\"Overview\"\n\t\t\t\t\tchild={CasesHistogram}\n\t\t\t\t\tchildProps={{\n\t\t\t\t\t\tsize: [900, 460],\n\t\t\t\t\t\tmargin: { top: 0, right: 30, bottom: 50, left: 30 },\n\t\t\t\t\t\tcases:this.state.data.getNodes(),\n\t\t\t\t\t\txScale:this.state.xScale,\n\t\t\t\t\t\tnodeDataSources:this.state.nodeDataSources,\n\t\t\t\t\t\tnodeDataStatuses:this.state.nodeDataStatuses,\n\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t\n\t\t\t\t<Panel\n\t\t\t\t\ttitle=\"Transmission network\"\n\t\t\t\t\tchild={TransmissionPanel}\n\t\t\t\t\tchildProps={{\n\t\t\t\t\t\tsize: [900, 460],\n\t\t\t\t\t\tmargin: { top: 0, right: 30, bottom: 80, left: 30 },\n\t\t\t\t\t\tselectedCases: this.state.selectedCases,\n\t\t\t\t\t\tselectSample: this.selectSample,\n\t\t\t\t\t\tdata:this.state.data,\n\t\t\t\t\t\txScale:this.state.xScale,\n\t\t\t\t\t\tnodeDataSources:this.state.nodeDataSources,\n\t\t\t\t\t\tnodeDataStatuses:this.state.nodeDataStatuses,\n\t\t\t\t\t\tedgeDataSources:this.state.edgeDataSources,\n\t\t\t\t\t\tedgeDataStatuses:this.state.edgeDataStatuses,\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t<Panel\n\t\t\t\t\ttitle=\"Phylogeny\"\n\t\t\t\t\tchild={FigTreeComponent}\n\t\t\t\t\tchildProps={{\n\t\t\t\t\t\tsvgId: \"tree\",\n\t\t\t\t\t\tcaseData:this.state.data,\n\t\t\t\t\t\ttreeString:this.state.treeString,\n\t\t\t\t\t\ttransmissionLayout:this.state.transmissionLayout,\n\t\t\t\t\t\twidth: 700,\n\t\t\t\t\t\theight:500\n\t\t\t\t\t\t\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.css';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}