(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(t,e,a){},25:function(t,e,a){t.exports=a.p+"static/media/logo.e67d1199.png"},27:function(t,e,a){t.exports=a(87)},32:function(t,e,a){},33:function(t,e,a){},62:function(t,e,a){},63:function(t,e,a){},64:function(t,e,a){},82:function(t,e,a){},83:function(t,e,a){},86:function(t,e,a){},87:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),r=a(19),s=a.n(r),o=(a(32),a(5)),c=a(4),l=a(3),u=a(9),d=a(8),h=a(6),p=a(10),g=a(25),f=a.n(g),m=(a(33),function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"header"},i.a.createElement("div",{style:{float:"left",margin:"10px"}},i.a.createElement("a",{href:"http://artic.network",target:"_blank",rel:"noopener noreferrer"},i.a.createElement("img",{src:f.a,alt:"logo",width:"132"}))),i.a.createElement("div",null,i.a.createElement("h1",{style:{marginTop:"60px",marginLeft:"10px"}},"TRAPPER"),i.a.createElement("h2",{style:{marginTop:"10px",marginLeft:"10px"}},"Transmission Reconstuction And Phylogenetics Promoting Early Response")))}}]),e}(i.a.Component)),y=a(14),v=a(7),b={position:"relative",width:"98%",height:"30px",minHeight:"30px",margin:"10px 10px 10px 10px",transition:"height 0.5s ease-out",WebkitTransition:"height 0.5s ease-out",border:"1px solid gray",borderRadius:"5px",borderLeft:"5px solid gray"},k=Object(y.a)({},b,{height:"500px",minHeight:"500px"}),x=Object(v.css)({cursor:"pointer",fontWeight:"bold",fontSize:"1.3em",paddingLeft:"20px",color:"#F0605C"}),E=function(t){var e=t.title,a=t.callback;return i.a.createElement("div",Object.assign({},x,{onClick:a}),e)},O=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(d.a)(e).call(this,t))).state={expanded:!1},a}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=Object(y.a)({},this.state.expanded?k:b,{borderColor:"#D8D8D8"});return i.a.createElement("div",{style:e},i.a.createElement(E,{title:this.props.title,callback:function(){return t.setState({expanded:!t.state.expanded})}}),this.state.expanded?i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement("div",{display:"inline-block"},i.a.createElement(this.props.child,this.props.childProps))):null)}}]),e}(i.a.Component),D=a(1),S=function(t,e,a){return a.indexOf(t)===e},j=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(d.a)(e).call(this,t))).drawEpiPlot=a.drawEpiPlot.bind(Object(h.a)(a)),a}return Object(p.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.drawEpiPlot()}},{key:"componentDidUpdate",value:function(){this.drawEpiPlot()}},{key:"drawEpiPlot",value:function(){var t=this,e=this.props.size[0],a=this.props.size[1],n=this.node,i=D.select(n).style("font","10px sans-serif");i.selectAll("g").remove();var r=a-this.props.margin.bottom-this.props.margin.top,s=this.props.xScale.range([this.props.margin.left,e-this.props.margin.left-this.props.margin.right]),o=[];this.props.nodeDataStatuses.forEach(function(e,a){e&&o.push(t.props.nodeDataSources[a])});var c=this.props.cases.filter(function(t){return o.indexOf(t.metaData.dataType)>-1}),l=D.scaleLinear().range([a-this.props.margin.top-this.props.margin.bottom,this.props.margin.bottom]).nice(),u=D.histogram().domain(s.domain()).thresholds(s.ticks(10)).value(function(t){return t.dateOfSampling?t.dateOfSampling:t.metaData["Date of onset"]})(c),d=D.histogram().domain(s.domain()).thresholds(s.ticks(10)).value(function(t){return t.dateOfSampling?t.dateOfSampling:t.metaData["Date of onset"]})(this.props.cases);l.domain([0,D.max(d,function(t){return t.length})]),i.selectAll("g").remove(),i.append("g").attr("transform","translate(".concat(this.props.margin.left,",").concat(this.props.margin.top,")"));var h=i.select("g");!function(t,e,a,n,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{rotate:0,xlab:"",ylab:""},s=D.axisBottom().scale(e).ticks(10),o=D.axisLeft().scale(a).ticks(5);t.append("g").attr("class","x-axis axis").attr("transform","translate(0,".concat(n[1]-i.top-i.bottom," )")).call(s).selectAll("text").attr("y",0).attr("x",9).attr("transform","rotate(".concat(r.rotate,")")).style("text-anchor","start"),t.append("text").attr("transform","translate(".concat(n[0]/2,",").concat(n[1]-i.top-i.bottom+30,")")).style("text-anchor","middle").text(r.xlab),t.append("g").attr("class","y-axis axis").attr("transform","translate(".concat(i.left,",0)")).call(o),t.append("text").attr("transform","rotate(-90)").attr("y",i.left-45).attr("x",0-n[1]/2).attr("dy","1em").style("text-anchor","middle").text(r.ylab)}(h,this.props.xScale,l,this.props.size,this.props.margin,{rotate:45,xlab:"",ylab:""}),h.append("g").attr("fill","grey").selectAll("rect").data(u).enter().append("rect").attr("x",function(t){return s(t.x0)+1}).attr("width",function(t){return Math.max(0,s(t.x1)-s(t.x0)-1)}).attr("y",function(t){return l(t.length)}).attr("height",function(t){return l(0)-l(t.length)}),h.append("g").attr("id","y-axis-label").attr("class","axis-label").attr("transform","translate(".concat(this.props.margin.left,",").concat(this.props.margin.top,")")).append("text").attr("transform","rotate(-90)").attr("y",0-this.props.margin.left-10).attr("x",0-r/2).attr("dy","1em").style("text-anchor","middle").text("Reported Cases")}},{key:"render",value:function(){var t=this;return i.a.createElement("div",null,i.a.createElement("svg",{ref:function(e){return t.node=e},width:this.props.size[0],height:this.props.size[1]}))}}]),e}(i.a.Component);v.css.global("body",{fontFamily:"Lato"}),v.css.global("a",{textDecoration:"none",color:"#5097BA",cursor:"pointer",fontWeight:600,fontSize:"94%"}),v.css.global("h1",{fontWeight:"bold",fontSize:"2em"}),v.css.global("h2",{fontWeight:"bold",fontSize:"1.5em"}),v.css.global("div, p",{fontWeight:"normal",fontSize:"1em"}),v.css.global(".dc-chart .axis path, .axis line",{fill:"none",stroke:"#000",strokeWidth:1,shapeRendering:"auto"}),v.css.global(".axis text",{fontSize:"12px"}),v.css.global(".brush rect.extent",{fill:"steelblue",fillOpacity:.125}),v.css.global(".brush .resize path",{fill:"#eee",stroke:"#666"});a(62),a(23);var T=a(2),L=function(){function t(e,a){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(c.a)(this,t),this.linkType=a,this.graph=e,this.nodes=this.graph.getNodes().map(function(t){return{key:t.key,height:null,spacingDimension:null}}),this.nodeMap=new Map(this.nodes.map(function(t){return[t.key,t]})),this.edges=this.graph.getEdgeList().map(function(t){return{key:t.key,source:n.getNode(t.source.key),target:n.getNode(t.target.key)}}),this.bilinks=[],i&&this.edges.forEach(function(t){var e=t.source,a=t.target,i={};n.nodes.push(i),n.edges.push({source:e,target:i},{source:i,target:a}),n.bilinks.push([e,i,a,{key:t.key}])}),this.currentSpacing=0}return Object(l.a)(t,[{key:"getNode",value:function(t){return this.nodeMap.get(t)}},{key:"getDataNode",value:function(t){return this.graph.getNode(t)}},{key:"getOutgoingEdges",value:function(t){return Object(T.a)(this.edges.filter(function(e){return e.source===t}))}},{key:"getDataEdge",value:function(t){return this.graph.getEdge(t)}},{key:"layOutNodes",value:function(t){var e=this;this.nodes.filter(function(t){return t.key}).forEach(function(a){return a.height=t(e.getDataNode(a.key))});var a=this.graph.getNodes().filter(function(t){return e.graph.getOutgoingEdges(t).filter(function(t){return t.metaData.dataType===e.linkType}).length>0&0===e.graph.getIncomingEdges(t).filter(function(t){return t.metaData.dataType===e.linkType}).length});a.length>1&&alert("The links used to set the transmission layout should link all nodes");var n=this.getNode(a[0].key);this.setSpacingDimension(n)}},{key:"setSpacingDimension",value:function(t){var e=this;t.spacingDimension=this.currentSpacing,this.currentSpacing++,console.log(t),console.log(this.getOutgoingEdges(t).filter(function(t){return t.key}).map(function(t){return e.getDataEdge(t.key)})),this.getOutgoingEdges(t).filter(function(t){return t.key}).filter(function(t){return e.getDataEdge(t.key).metaData.dataType===e.linkType}).map(function(t){return t.target}).forEach(function(t){return e.setSpacingDimension(t)})}}]),t}(),w=(Object(v.css)({textAlign:"center",fontWeight:"bold",fontSize:"1em"}),Object(v.css)({zIndex:20,position:"absolute",borderRadius:"5px",padding:"5px",margin:"auto",backgroundColor:"hsla(0,0%,0%,.8)",color:"white",pointerEvents:"none",visibility:"hidden",fontSize:"14px",fontWeight:"700"})),N=Object(v.css)({zIndex:20,position:"absolute",borderRadius:"5px",padding:"5px",margin:"auto",backgroundColor:"rgb(245,245,245)",color:"hsla(0,0%,0%,.8)",pointerEvents:"none",visibility:"hidden",fontSize:"14px",fontWeight:"700"}),C=(a(63),a(64),function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(d.a)(e).call(this,t))).drawTransPlot=a.drawTransPlot.bind(Object(h.a)(a)),a.updateNodeVisibility=a.updateNodeVisibility.bind(Object(h.a)(a)),a.updateEdgeVisibility=a.updateEdgeVisibility.bind(Object(h.a)(a)),a}return Object(p.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.drawTransPlot()}},{key:"componentDidUpdate",value:function(){this.updateNodeVisibility(),this.updateEdgeVisibility()}},{key:"updateNodeVisibility",value:function(){var t=this;this.props.nodeDataStatuses.forEach(function(e,a){var n=e?1:0,i=".".concat(t.props.nodeDataSources[a].replace(/ /g,"-"));D.selectAll("".concat(i,".transmission-node")).transition().duration(300).ease(D.easeLinear).style("opacity",n)})}},{key:"updateEdgeVisibility",value:function(){var t=this;this.props.edgeDataStatuses.forEach(function(e,a){var n=e?1:0,i=".".concat(t.props.edgeDataSources[a].replace(/ /g,"-"));D.selectAll("".concat(i,".link")).transition().duration(300).ease(D.easeLinear).style("opacity",n)})}},{key:"drawTransPlot",value:function(){var t=this.node,e=this.infoRef,a=this.infoRef2,n=this;var i=this.props.size[0],r=this.props.size[1],s=D.select(t).style("font","10px sans-serif");s.selectAll("g").remove(),s.append("g").attr("transform","translate(".concat(this.props.margin.left,",").concat(this.props.margin.top,")"));var o=s.select("g"),c=new L(this.props.data,"TransPhylo");c.layOutNodes(function(t){return t.metaData["Date of onset"]});var l=D.scaleLinear().domain(D.extent(c.nodes,function(t){return t.height})).range([this.props.margin.left,i-this.props.margin.left-this.props.margin.right]).nice(),u=D.scaleLinear().domain(D.extent(c.nodes,function(t){return t.spacingDimension})).range([r-this.props.margin.top-this.props.margin.bottom,this.props.margin.bottom]).nice(),d=this.props.xScale.range([this.props.margin.left,i-this.props.margin.left-this.props.margin.right]),h=D.axisBottom().scale(d);o.append("g").attr("class","x-axis axis").attr("transform","translate(0,".concat(r-this.props.margin.top-this.props.margin.bottom+25," )")).call(h).selectAll("text").attr("y",0).attr("x",9).attr("transform","rotate(".concat(45,")")).style("text-anchor","start");var p=7,g=D.forceX(function(t){return l(t.height)}).strength(.7),f=g.initialize;g.initialize=function(t){f(t.filter(function(t){return t.key}))};var m=D.forceY(function(t){return u(t.spacingDimension)}).strength(.3),y=m.initialize;m.initialize=function(t){y(t.filter(function(t){return t.key&&t.spacingDimension}))};var v=D.forceSimulation().force("collide",D.forceCollide(function(t){return p})).force("xPosition",g).force("yPosition",m).force("center",D.forceCenter(i/2,r/2)).force("charge",D.forceManyBody().strength(-1)).force("link",D.forceLink().distance(5).strength(.5)),b=o.append("g").selectAll(".link").data(c.bilinks).enter().append("path").attr("class",function(t){return"".concat(c.getDataEdge(t[3].key).metaData.dataType.replace(/ /g,"-")," link")}).style("stroke","#bbb").style("stroke-width",3).style("fill","none").on("mouseover",function(t,e){var n=t[1].x<.5*l.range()[1]?"".concat(l.range()[0]+t[1].x,"px"):"",i=t[1].x>.5*l.range()[1]?"".concat(l.range()[1]-t[1].x,"px"):"",r=c.graph.getEdge(t[3].key),s=c.graph.getEdgeHtml(r);D.select(a).style("left",n).style("right",i).style("top","".concat(t[1].y,"px")).style("visibility","visible").html(s)}).on("mouseout",function(){D.select(a).style("visibility","hidden")}),k=o.append("g").selectAll("circle").data(c.nodes.filter(function(t){return t.key})).enter().append("circle").attr("r",function(t){return"Observed"===c.getDataNode(t.key).metaData.dataType?p:p-1.5}).attr("class",function(t){return"".concat(c.getDataNode(t.key).metaData.dataType.replace(/ /g,"-")," transmission-node")}).call(D.drag().on("start",function(t){D.event.active||v.alphaTarget(.5).restart();t.fx=t.x,t.fy=t.y}).on("drag",function(t){t.fx=D.event.x,t.fy=D.event.y}).on("end",function(t){D.event.active||v.alphaTarget(0);t.fx=null,t.fy=null})).on("mouseover",function(t,a){var n=t.x<.5*l.range()[1]?"".concat(l.range()[0]+t.x,"px"):"",i=t.x>.5*l.range()[1]?"".concat(l.range()[1]-t.x,"px"):"",r=c.graph.getNode(t.key),s=c.graph.getNodeHtml(r);D.select(e).style("left",n).style("right",i).style("top","".concat(t.y,"px")).style("visibility","visible").html(s)}).on("mouseout",function(){D.select(e).style("visibility","hidden")});function x(t){var e={};return e.x=Math.max(p,Math.min(i-n.props.margin.left-n.props.margin.right-p,t.x)),e.y=Math.min(r-n.props.margin.bottom-n.props.margin.top+25-p,t.y),e}function E(t){var e=x(t[0]),a=x(t[1]),n=x(t[2]);return"M".concat(e.x,",").concat(e.y,"S").concat(a.x,",").concat(a.y," ").concat(n.x,",").concat(n.y)}function O(t){var e=x(t);return"translate( ".concat(e.x," , ").concat(e.y," )")}v.nodes(c.nodes).on("tick",function(){b.attr("d",E),k.attr("transform",O)}),v.force("link").links(c.edges),this.updateNodeVisibility()}},{key:"render",value:function(){var t=this;return i.a.createElement("div",null,i.a.createElement("div",Object.assign({},w,{style:{maxWidth:this.props.size[0]/2},ref:function(e){t.infoRef=e}})),i.a.createElement("div",Object.assign({},N,{style:{maxWidth:this.props.size[0]/2},ref:function(e){t.infoRef2=e}})),i.a.createElement("svg",{ref:function(e){return t.node=e},width:this.props.size[0],height:this.props.size[1]}))}}]),e}(i.a.Component)),P=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(d.a)(e).call(this,t))).state={},a}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(C,this.props),">")}}]),e}(i.a.Component),z=D.timeParse("%Y-%m-%d"),A=function(t){var e=["Id","Date of sampling"],a={id:t.Id,dateOfSampling:z(t["Date of sampling"]),metaData:{}};return Object.keys(t).forEach(function(n){-1===e.indexOf(n)&&(n.toLowerCase().indexOf("date")>-1?a.metaData[n]=z(t[n]):a.metaData[n]=t[n])}),a},M=function(t){var e=["Source","Target"],a={source:t.Source,target:t.Target,metaData:{}};return Object.keys(t).forEach(function(n){-1===e.indexOf(n)&&(a.metaData[n]=t[n])}),a},I=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(c.a)(this,t),this.nodeList=e,this.nodeList.forEach(function(t){t.key=Symbol()}),this.nodeMap=new Map(this.nodeList.map(function(t){return[t.key,t]})),this.edgeList=a,this.edgeList.forEach(function(t){t.key=Symbol()}),this.edgeMap=new Map(this.edgeList.map(function(t){return[t.key,t]})),this.traversalDirection="forward"}return Object(l.a)(t,[{key:"addNode",value:function(t){-1===Object.keys(t).indexOf("key")&&(t.key=Symbol()),this.nodeList.push(t),this.nodeMap.set(t.key,t)}},{key:"addEdge",value:function(t){-1===Object.keys(t).indexOf("key")&&(t.key=Symbol()),this.edgeList.push(t),this.edgeMap.set(t.key,t)}},{key:"getNode",value:function(t){return this.nodeMap.get(t)}},{key:"getExternalNodes",value:function(){var t=this;return this.nodeList.filter(function(e){return 0===t.getOutgoingEdges().length})}},{key:"getNodeFromKeyValuePair",value:function(t,e){return this.nodeList.filter(function(a){return a[t]===e})[0]}},{key:"getNodeHtml",value:function(t){for(var e="".concat(t.id," </br>"),a=Object.keys(t.metaData),n=0;n<a.length;n++){var i=a[n];e=i.toLowerCase().indexOf("date")>-1?"".concat(e).concat(i,": ").concat(t.metaData[i].toISOString().substring(0,10),"</br>"):"".concat(e).concat(i,": ").concat(t.metaData[i],"</br>")}return e}},{key:"getNodes",value:function(){return this.nodeList}},{key:"removeNode",value:function(t){var e=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.getEdges(t).forEach(function(t){return e.removeEdge(t)});var a=t.key;this.nodeList=this.nodeList.filter(function(t){return t.key!==a}),this.nodeMap.delete(a)}},{key:"getEdge",value:function(t){return this.edgeMap.get(t)}},{key:"getEdgeHtml",value:function(t){for(var e="Source:".concat(t.source.id," </br> Target: ").concat(t.target.id,"</br>"),a=Object.keys(t.metaData),n=0;n<a.length;n++){var i=a[n];e=i.toLowerCase().indexOf("date")>-1?"".concat(e).concat(i,": ").concat(t.metaData[i].toISOString().substring(0,10),"</br>"):"".concat(e).concat(i,": ").concat(t.metaData[i],"</br>")}return e}},{key:"getIncomingEdges",value:function(t){return Object(T.a)(this.edgeList.filter(function(e){return e.target===t}))}},{key:"getOutgoingEdges",value:function(t){return Object(T.a)(this.edgeList.filter(function(e){return e.source===t}))}},{key:"getEdges",value:function(t){return[].concat(Object(T.a)(this.getOutgoingEdges(t)),Object(T.a)(this.getIncomingEdges(t)))}},{key:"getEdgeList",value:function(){return this.edgeList}},{key:"removeEdge",value:function(t){var e=t.key;this.edgeList=this.edgeList.filter(function(t){return t.key!==e}),this.edgeMap.delete(e)}},{key:"makeEdge",value:function(t,e){this.addEdge({source:t,target:e})}},{key:"insertNode",value:function(t,e){var a={source:e.source,target:t},n={source:t,target:e.taget};this.removeEdge(e),this.addEdge(a),this.addEdge(n)}},{key:"getClusters",value:function(){var t=this,e=this.edgeList.map(function(t){return t.metaData.dataType}).filter(S),a=[],n=!0,i=!1,r=void 0;try{for(var s,o=function(){var e=s.value;console.log(e),t.nodeList.forEach(function(t){return t.visited=!1}),t.traversalDirection="forward",t.nodeList.forEach(function(n){if(!n.visited){var i={nodes:[n],externalNodes:[]};n.visited=!0,t.getEdges(n).filter(function(t){return t.metaData.dataType===e}).forEach(function(e){return t.traverse(n,e,i)}),1===i.nodes.length&&0===i.externalNodes.length&&i.externalNodes.push(n),a.push(i)}})},c=e[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)o()}catch(l){i=!0,r=l}finally{try{n||null==c.return||c.return()}finally{if(i)throw r}}return a}},{key:"traverse",value:function(t,e,a){var n,i=this,r=!1;t===e.source?(n=e.target,this.traversalDirection="forward"):(n=e.source,"forward"===this.traversalDirection&&(r=!0),this.traversalDirection="backward"),n.visited?r&&a.externalNodes.push(t):(n.visited=!0,a.nodes.push(n),this.getEdges(n).forEach(function(t){return i.traverse(n,t,a)}))}}]),t}(),B=a(26),R=function(t){return i.a.createElement("div",null,i.a.createElement("span",{style:{paddingRight:"10px"}}," ",t.title," :"),i.a.createElement("label",{className:"switch"},i.a.createElement("input",{type:"checkbox",readOnly:!0,onClick:t.callback,checked:t.status}),i.a.createElement("span",{className:"slider round"})))},W=(a(82),function(t){var e=t.nodeOptions.map(function(e,a){var n=t.nodeDataCallback(a);return i.a.createElement(R,{key:a.toString(),title:e,status:t.nodeStatus[a],callback:n})}),a=t.edgeOptions.map(function(e,a){var n=t.edgeDataCallback(a);return i.a.createElement(R,{key:a.toString(),title:e,status:t.edgeStatus[a],callback:n})});return i.a.createElement(B.push,{left:!0,noOverlay:!0,push:!0,pageWrapId:"page-wrap",outerContainerId:"outer-container"},i.a.createElement("h4",null,"Data sources"),i.a.createElement("h5",null,"Cases:"),e,i.a.createElement("h5",null,"Transmission events"),a,i.a.createElement("h4",null,"Color options"),i.a.createElement("h5",null,"TODO"),i.a.createElement("h4",null,"Tree"),i.a.createElement(R,{title:"Transmission Layout",status:t.transmissionLayout,callback:t.transmissionCallBack}))}),V=(a(83),a(15)),F=a(13),H=(a(86),function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(d.a)(e).call(this,t))).drawTree=a.drawTree.bind(Object(h.a)(a)),a}return Object(p.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.drawTree()}},{key:"componentDidUpdate",value:function(){var t=this.props.transmissionLayout?F.d:F.c;this.state.FigTree.treeLayout=t,this.state.FigTree.update()}},{key:"drawTree",value:function(){var t=F.b.parseNewick(this.props.treeString),e=document.getElementById(this.props.svgId),a=new F.a(e,t,{top:10,bottom:60,left:10,right:50},{nodeRadius:4,xAxisTitle:""});D.select(e).selectAll(".internal-node").attr("display","none"),D.select(e).selectAll(".axis").remove();var n={};this.props.caseData.getNodes().forEach(function(e){t.nodes.map(function(t){return t.name}).indexOf(e.id)>-1&&(n[e.id]={"Date of Sampling":e.dateOfSampling?e.dateOfSampling.toISOString().substring(0,10):"",Location:e.metaData.Location?e.metaData.Location:"",Outcome:e.metaData.Outcome?e.metaData.Outcome:"",dataSource:e.metaData.dataSource?e.metaData.dataSource:""})}),t.annotateTips(n),a.setNodeLabels(),a.addToolTip(".node",F.a.nodeInfo),a.onClickBranch(F.a.reroot),a.hilightExternalNodes(),a.onClickNode(F.a.rotate),t.annotateNodesFromTips("Location"),t.order(t.rootNode,!1),this.props.transmissionLayout&&(a.treeLayout=F.d),a.update(),this.setState({FigTree:a,Tree:t})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{id:"tooltip"}),i.a.createElement("svg",{id:this.props.svgId,width:this.props.width,height:this.props.height}))}}]),e}(n.Component)),U=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(u.a)(this,Object(d.a)(e).call(this,t))).addCases=function(t){t.forEach(function(t){a.state.data.addNode(t)}),a.setState({xScale:D.scaleTime().domain(D.extent(t,function(t){return t.dateOfSampling?t.dateOfSampling:t.metaData["Date of onset"]})).nice()})},a.addEdges=function(t){t.forEach(function(t){var e=a.state.data.getNodeFromKeyValuePair("id",t.source),n=a.state.data.getNodeFromKeyValuePair("id",t.target);a.state.data.addEdge({source:e,target:n,metaData:t.metaData})})},a.state={byLocation:!1,selectedCases:[],counter:0,data:new I,transmissionLayout:!1,resolved:!1,nodeDataSources:[],nodeDataStatuses:[]},a.selectSample=a.selectSample.bind(Object(h.a)(a)),a.addCases=a.addCases.bind(Object(h.a)(a)),a.addEdges=a.addEdges.bind(Object(h.a)(a)),a.checkThatBox=a.checkThatBox.bind(Object(h.a)(a)),a.checkThatBoxArray=a.checkThatBoxArray.bind(Object(h.a)(a)),a}return Object(p.a)(e,t),Object(l.a)(e,[{key:"checkThatBox",value:function(t){var e=this;return function(){var a={};a[t]=!e.state[t],e.setState(a)}}},{key:"checkThatBoxArray",value:function(t){var e=this;return function(a){return function(){var n={};n[t]=e.state[t],n[t][a]=!e.state[t][a],e.setState(n)}}}},{key:"selectSample",value:function(t){var e=this.state.selectedCases;if(e.map(function(t){return t.Id}).indexOf(t.Id)>-1){var a=e.filter(function(e){return e!==t});this.setState({selectedCases:a})}else e.push(t),this.setState({selectedCases:e})}},{key:"componentDidMount",value:function(){var t=this,e="https://raw.githubusercontent.com/jtmccr1/trapper/master/src/";Promise.all([Object(V.a)("".concat(e,"data/lineList.csv")),Object(V.a)("".concat(e,"data/UnsampledTrueCases.csv")),Object(V.a)("".concat(e,"data/UnsampledTransPhyloCases.csv")),Object(V.a)("".concat(e,"data/epiContacts.csv")),Object(V.a)("".concat(e,"data/PerfectGeneticLinks.csv")),Object(V.a)("".concat(e,"data/TransPhyloLinks.csv"))]).then(function(e){var a=Object(o.a)(e,6),n=a[0],i=a[1],r=a[2],s=a[3],c=a[4],l=a[5],u=n.map(function(t){return A(t)});t.addCases(u);var d=i.map(function(t){return A(t)});t.addCases(d);var h=r.map(function(t){return A(t)});t.addCases(h);var p=s.map(function(t){return M(t)});t.addEdges(p);var g=c.map(function(t){return M(t)});t.addEdges(g);var f=l.map(function(t){return M(t)});return t.addEdges(f),!0}).then(function(a){return fetch("".concat(e,"data/sampledTree.phy")).then(function(e){return e.text().then(function(e){t.setState({treeString:e})})}),!0}).then(function(e){return t.setState({nodeDataSources:t.state.data.getNodes().map(function(t){return t.metaData.dataType}).filter(S)}),t.setState({nodeDataStatuses:t.state.data.getNodes().map(function(t){return t.metaData.dataType}).filter(S).map(function(t){return!0})}),t.setState({edgeDataSources:t.state.data.getEdgeList().map(function(t){return t.metaData.dataType}).filter(S)}),t.setState({edgeDataStatuses:t.state.data.getEdgeList().map(function(t){return t.metaData.dataType}).filter(S).map(function(t){return!0})}),!0}).then(function(e){t.setState({resolved:e})})}},{key:"render",value:function(){return this.state.resolved?i.a.createElement("div",{id:"outer-contanier",style:{overflow:"auto",height:"500%"}},i.a.createElement(m,null),i.a.createElement(W,{nodeOptions:this.state.nodeDataSources,nodeStatus:this.state.nodeDataStatuses,edgeOptions:this.state.edgeDataSources,edgeStatus:this.state.edgeDataStatuses,nodeDataCallback:this.checkThatBoxArray("nodeDataStatuses"),edgeDataCallback:this.checkThatBoxArray("edgeDataStatuses"),transmissionLayout:this.state.transmissionLayout,transmissionCallBack:this.checkThatBox("transmissionLayout")}),i.a.createElement("div",{className:"Panels",id:"page-wrap"},i.a.createElement(O,{title:"Overview",child:j,childProps:{size:[900,460],margin:{top:0,right:30,bottom:50,left:30},cases:this.state.data.getNodes(),xScale:this.state.xScale,nodeDataSources:this.state.nodeDataSources,nodeDataStatuses:this.state.nodeDataStatuses}}),i.a.createElement(O,{title:"Transmission network",child:P,childProps:{size:[900,460],margin:{top:0,right:30,bottom:80,left:30},selectedCases:this.state.selectedCases,selectSample:this.selectSample,data:this.state.data,xScale:this.state.xScale,nodeDataSources:this.state.nodeDataSources,nodeDataStatuses:this.state.nodeDataStatuses,edgeDataSources:this.state.edgeDataSources,edgeDataStatuses:this.state.edgeDataStatuses}}),i.a.createElement(O,{title:"Phylogeny",child:H,childProps:{svgId:"tree",caseData:this.state.data,treeString:this.state.treeString,transmissionLayout:this.state.transmissionLayout,width:700,height:500}}))):i.a.createElement("div",null,"Loading...")}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.3509fe8a.chunk.js.map